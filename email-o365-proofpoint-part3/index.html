
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A professional blog showcasing business problem solutions.">
      
      
      
        <link rel="canonical" href="https://munishsethi.com/email-o365-proofpoint-part3/">
      
      
        <link rel="prev" href="../email-o365-proofpoint-part2/">
      
      
        <link rel="next" href="../email-o365-proofpoint-part4/">
      
      
      <link rel="icon" href="../None">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>O365 and Proof Point Essentials - Part 3 - Munish(s) Blog</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/custom.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#email-security-implementation-o365-and-proof-point-essentials-series" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Munish(s) Blog" class="md-header__button md-logo" aria-label="Munish(s) Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Munish(s) Blog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              O365 and Proof Point Essentials - Part 3
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Munish(s) Blog" class="md-nav__button md-logo" aria-label="Munish(s) Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Munish(s) Blog
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Azure
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Azure
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-ad-certificate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate Based Authentication
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-billing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Download Azure Bill
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Download Azure Resource
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-query-recovery-services-vault/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Query Recovery Services Vault
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-ad-user/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Entra Users, User Groups and Licence assignments
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-ad-user-devices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Entra User Devices
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-container-schedule/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Orchestrating Scheduled Jobs (Container Instances)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../devops-build-container/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DevOps Build Container
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../devops-deploy-container-iac/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DevOps Deploy Container IaC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../devops-deploy-container-github-action/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DevOps Deploy Container Github Actions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../avd-custon-image-compute-gallery-part1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Building and Publishing an Custom Image
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../avd-publish-part2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deploying Azure Virtual Desktop (AVD) Desktops
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../avd-cleanup-obsolete-fsLogix-profiles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cleanup Obsolete FXLogix Profiles(AVD)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-bcpdr-part1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Business Coninuity Program / Diasister Recovery - Part 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-bcpdr-part2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Business Continuity Program / Disaster Recovery - Part 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-bcpdr-github-action/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Business Continuity Program / Disaster Recovery - Git Hub Action
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-restore-from-backup-part1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Restore VM from RSV Backup - Part 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-restore-from-backup-part2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Restore VM from RSV Backup - Part 2
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Fabric
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Fabric
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fabric-wharehouse-fact-import/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Warehouse data import
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Cisco Meraki, Nagios XI & Manage Engine
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Cisco Meraki, Nagios XI & Manage Engine
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../meraki-unused-device-sync/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cisco Meraki Unused Devices
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../meraki-nagios-device-sync/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cisco Meraki Devices Discovery and Nagios Integration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../monitoring-itsm-integration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Integrating Monitoring System with ITSM System
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../meraki-vm-deployment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deploying Cisco Meraki vMX
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Active Directory Domain Services
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Active Directory Domain Services
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adds-user-creation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Create ADDS User
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adds-user-update/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Update ADDS User
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    SAP
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            SAP
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sap-rfc-python-container/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Setup PyRFC in your Container
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sap-rfc-python/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Calling SAP RFC Function Modules from Python
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sap-system-start-stop/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Automating SAP System Start/Stop Operations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    O365
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            O365
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adaptive-card-consultant-review-part1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Outlook Actionable Adaptive Card - Part 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adaptive-card-consultant-review-part2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Outlook Actionable Adaptive Card - Part 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sharepoint-sites-enumeration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sharepoint Sites Enumeration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sharepoint-site-library-enumeration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sharepoint Document Library Enumeration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sharepoint-site-library-to-azure-fileshare/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Migrate Sharepoint Document Library to Azure File Share
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sap-concur-expense-reports-aggregation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Concur Expense Report Aggregation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../teams-user-number-assignment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Get all Teams Phone Assignment(s)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../deprovision-user/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deprovison User
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tenantallowblocklist/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tenant Allow Block List - False Positive
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../email-o365-proofpoint-part1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    O365 and Proof Point Essentials - Part 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../email-o365-proofpoint-part2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    O365 and Proof Point Essentials - Part 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    O365 and Proof Point Essentials - Part 3
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    O365 and Proof Point Essentials - Part 3
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#part-3-office-365-connector-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Part 3: Office 365 Connector Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Part 3: Office 365 Connector Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#series-navigation" class="md-nav__link">
    <span class="md-ellipsis">
      📚 Series Navigation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-well-configure" class="md-nav__link">
    <span class="md-ellipsis">
      🎯 What We'll Configure
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mail-flow-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      🔄 Mail Flow Architecture
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      🔑 Prerequisites
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#connector-1-proofpoint-inbound" class="md-nav__link">
    <span class="md-ellipsis">
      📥 Connector 1: Proofpoint Inbound
    </span>
  </a>
  
    <nav class="md-nav" aria-label="📥 Connector 1: Proofpoint Inbound">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-create-the-inbound-connector" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Create the Inbound Connector
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-configure-partner-organization-identity" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Configure Partner Organization Identity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-configure-security-restrictions" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Configure Security Restrictions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 3: Configure Security Restrictions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tls-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      TLS Requirements:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ip-address-restrictions" class="md-nav__link">
    <span class="md-ellipsis">
      IP Address Restrictions:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-apply-advanced-security-setting" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: Apply Advanced Security Setting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 4: Apply Advanced Security Setting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-this-setting-matters" class="md-nav__link">
    <span class="md-ellipsis">
      Why This Setting Matters:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#connector-2-proofpoint-outbound" class="md-nav__link">
    <span class="md-ellipsis">
      📤 Connector 2: ProofPoint Outbound
    </span>
  </a>
  
    <nav class="md-nav" aria-label="📤 Connector 2: ProofPoint Outbound">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-create-the-outbound-connector" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Create the Outbound Connector
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-configure-domain-scope" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Configure Domain Scope
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-configure-routing" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Configure Routing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-configure-security-settings" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: Configure Security Settings
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#connector-3-smtp-relay" class="md-nav__link">
    <span class="md-ellipsis">
      🖥️ Connector 3: SMTP Relay
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🖥️ Connector 3: SMTP Relay">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-create-the-smtp-relay-connector" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Create the SMTP Relay Connector
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-configure-ip-address-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Configure IP Address Authentication
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-additional-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Additional Requirements
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 3: Additional Requirements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#critical-connection" class="md-nav__link">
    <span class="md-ellipsis">
      🔗 Critical Connection:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transport-rule-proofpoint-spam-bypass" class="md-nav__link">
    <span class="md-ellipsis">
      🛡️ Transport Rule: ProofPoint Spam Bypass
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🛡️ Transport Rule: ProofPoint Spam Bypass">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-create-the-transport-rule" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Create the Transport Rule
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-configure-conditions" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Configure Conditions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-configure-actions" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Configure Actions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-configure-rule-settings" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: Configure Rule Settings
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 4: Configure Rule Settings">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-this-rule-is-essential" class="md-nav__link">
    <span class="md-ellipsis">
      Why This Rule is Essential:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-verification" class="md-nav__link">
    <span class="md-ellipsis">
      ⚙️ Configuration Verification
    </span>
  </a>
  
    <nav class="md-nav" aria-label="⚙️ Configuration Verification">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-verify-connectors" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Verify Connectors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-verify-transport-rule" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Verify Transport Rule
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-test-mail-flow" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Test Mail Flow
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#critical-security-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      🚨 Critical Security Considerations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🚨 Critical Security Considerations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ip-address-management" class="md-nav__link">
    <span class="md-ellipsis">
      IP Address Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connector-security" class="md-nav__link">
    <span class="md-ellipsis">
      Connector Security
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transport-rule-priority" class="md-nav__link">
    <span class="md-ellipsis">
      Transport Rule Priority
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#monitoring-and-maintenance" class="md-nav__link">
    <span class="md-ellipsis">
      📊 Monitoring and Maintenance
    </span>
  </a>
  
    <nav class="md-nav" aria-label="📊 Monitoring and Maintenance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#weekly-checks" class="md-nav__link">
    <span class="md-ellipsis">
      Weekly Checks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monthly-checks" class="md-nav__link">
    <span class="md-ellipsis">
      Monthly Checks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quarterly-checks" class="md-nav__link">
    <span class="md-ellipsis">
      Quarterly Checks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting-common-issues" class="md-nav__link">
    <span class="md-ellipsis">
      🔧 Troubleshooting Common Issues
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🔧 Troubleshooting Common Issues">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inbound-mail-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Inbound Mail Issues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outbound-mail-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Outbound Mail Issues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smtp-relay-issues" class="md-nav__link">
    <span class="md-ellipsis">
      SMTP Relay Issues
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      📋 Configuration Checklist
    </span>
  </a>
  
    <nav class="md-nav" aria-label="📋 Configuration Checklist">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#connectors-created" class="md-nav__link">
    <span class="md-ellipsis">
      Connectors Created:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security-settings-applied" class="md-nav__link">
    <span class="md-ellipsis">
      Security Settings Applied:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transport-rules" class="md-nav__link">
    <span class="md-ellipsis">
      Transport Rules:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-completed" class="md-nav__link">
    <span class="md-ellipsis">
      Testing Completed:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-mistakes-to-avoid" class="md-nav__link">
    <span class="md-ellipsis">
      ⚠️ Common Mistakes to Avoid
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#whats-next" class="md-nav__link">
    <span class="md-ellipsis">
      🎯 What's Next
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🎯 What&#39;s Next">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#series-navigation_1" class="md-nav__link">
    <span class="md-ellipsis">
      📖 Series Navigation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../email-o365-proofpoint-part4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    O365 and Proof Point Essentials - Part 4
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../email-o365-proofpoint-part5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    O365 and Proof Point Essentials - Part 5
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    UKG
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            UKG
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ukg-sftp-file-transfer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Secure File Transfer with UKG Dimensions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ukg-api-employee-verification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Employee Verification via API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ukg-api-integration-and-dataview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Automating Integration Execution and Dataview extract
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Misc
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Misc
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../proofpoint-user-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Proof Point User Management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../github-clean-deployments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Clean GitHub Deployments
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../proofpointo365connector/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Understanding DMARC/Spoofing, O365 with ProofPoint
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#part-3-office-365-connector-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Part 3: Office 365 Connector Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Part 3: Office 365 Connector Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#series-navigation" class="md-nav__link">
    <span class="md-ellipsis">
      📚 Series Navigation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-well-configure" class="md-nav__link">
    <span class="md-ellipsis">
      🎯 What We'll Configure
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mail-flow-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      🔄 Mail Flow Architecture
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      🔑 Prerequisites
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#connector-1-proofpoint-inbound" class="md-nav__link">
    <span class="md-ellipsis">
      📥 Connector 1: Proofpoint Inbound
    </span>
  </a>
  
    <nav class="md-nav" aria-label="📥 Connector 1: Proofpoint Inbound">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-create-the-inbound-connector" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Create the Inbound Connector
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-configure-partner-organization-identity" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Configure Partner Organization Identity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-configure-security-restrictions" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Configure Security Restrictions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 3: Configure Security Restrictions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tls-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      TLS Requirements:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ip-address-restrictions" class="md-nav__link">
    <span class="md-ellipsis">
      IP Address Restrictions:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-apply-advanced-security-setting" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: Apply Advanced Security Setting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 4: Apply Advanced Security Setting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-this-setting-matters" class="md-nav__link">
    <span class="md-ellipsis">
      Why This Setting Matters:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#connector-2-proofpoint-outbound" class="md-nav__link">
    <span class="md-ellipsis">
      📤 Connector 2: ProofPoint Outbound
    </span>
  </a>
  
    <nav class="md-nav" aria-label="📤 Connector 2: ProofPoint Outbound">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-create-the-outbound-connector" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Create the Outbound Connector
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-configure-domain-scope" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Configure Domain Scope
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-configure-routing" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Configure Routing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-configure-security-settings" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: Configure Security Settings
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#connector-3-smtp-relay" class="md-nav__link">
    <span class="md-ellipsis">
      🖥️ Connector 3: SMTP Relay
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🖥️ Connector 3: SMTP Relay">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-create-the-smtp-relay-connector" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Create the SMTP Relay Connector
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-configure-ip-address-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Configure IP Address Authentication
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-additional-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Additional Requirements
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 3: Additional Requirements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#critical-connection" class="md-nav__link">
    <span class="md-ellipsis">
      🔗 Critical Connection:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transport-rule-proofpoint-spam-bypass" class="md-nav__link">
    <span class="md-ellipsis">
      🛡️ Transport Rule: ProofPoint Spam Bypass
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🛡️ Transport Rule: ProofPoint Spam Bypass">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-create-the-transport-rule" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Create the Transport Rule
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-configure-conditions" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Configure Conditions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-configure-actions" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Configure Actions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-configure-rule-settings" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: Configure Rule Settings
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 4: Configure Rule Settings">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-this-rule-is-essential" class="md-nav__link">
    <span class="md-ellipsis">
      Why This Rule is Essential:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-verification" class="md-nav__link">
    <span class="md-ellipsis">
      ⚙️ Configuration Verification
    </span>
  </a>
  
    <nav class="md-nav" aria-label="⚙️ Configuration Verification">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-verify-connectors" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Verify Connectors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-verify-transport-rule" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Verify Transport Rule
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-test-mail-flow" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Test Mail Flow
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#critical-security-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      🚨 Critical Security Considerations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🚨 Critical Security Considerations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ip-address-management" class="md-nav__link">
    <span class="md-ellipsis">
      IP Address Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connector-security" class="md-nav__link">
    <span class="md-ellipsis">
      Connector Security
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transport-rule-priority" class="md-nav__link">
    <span class="md-ellipsis">
      Transport Rule Priority
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#monitoring-and-maintenance" class="md-nav__link">
    <span class="md-ellipsis">
      📊 Monitoring and Maintenance
    </span>
  </a>
  
    <nav class="md-nav" aria-label="📊 Monitoring and Maintenance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#weekly-checks" class="md-nav__link">
    <span class="md-ellipsis">
      Weekly Checks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monthly-checks" class="md-nav__link">
    <span class="md-ellipsis">
      Monthly Checks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quarterly-checks" class="md-nav__link">
    <span class="md-ellipsis">
      Quarterly Checks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting-common-issues" class="md-nav__link">
    <span class="md-ellipsis">
      🔧 Troubleshooting Common Issues
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🔧 Troubleshooting Common Issues">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inbound-mail-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Inbound Mail Issues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outbound-mail-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Outbound Mail Issues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smtp-relay-issues" class="md-nav__link">
    <span class="md-ellipsis">
      SMTP Relay Issues
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      📋 Configuration Checklist
    </span>
  </a>
  
    <nav class="md-nav" aria-label="📋 Configuration Checklist">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#connectors-created" class="md-nav__link">
    <span class="md-ellipsis">
      Connectors Created:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security-settings-applied" class="md-nav__link">
    <span class="md-ellipsis">
      Security Settings Applied:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transport-rules" class="md-nav__link">
    <span class="md-ellipsis">
      Transport Rules:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-completed" class="md-nav__link">
    <span class="md-ellipsis">
      Testing Completed:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-mistakes-to-avoid" class="md-nav__link">
    <span class="md-ellipsis">
      ⚠️ Common Mistakes to Avoid
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#whats-next" class="md-nav__link">
    <span class="md-ellipsis">
      🎯 What's Next
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🎯 What&#39;s Next">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#series-navigation_1" class="md-nav__link">
    <span class="md-ellipsis">
      📖 Series Navigation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="email-security-implementation-o365-and-proof-point-essentials-series">📧 Email Security Implementation (O365 and Proof Point Essentials) Series</h1>
<h2 id="part-3-office-365-connector-configuration">Part 3: Office 365 Connector Configuration</h2>
<hr />
<h3 id="series-navigation">📚 <strong>Series Navigation</strong></h3>
<ul>
<li><a href="../email-o365-proofpoint-part1/">Part 1: Understanding SPF, DKIM, and DMARC</a></li>
<li><a href="../email-o365-proofpoint-part2/">Part 2: DNS Configuration and Setup</a></li>
<li><strong>Part 3: Office 365 Connector Configuration</strong> <em>(Current)</em></li>
<li><a href="../email-o365-proofpoint-part4/">Part 4: Proofpoint Integration Setup</a></li>
<li><a href="../email-o365-proofpoint-part5/">Part 5: Testing and Troubleshooting</a></li>
</ul>
<hr />
<h2 id="what-well-configure">🎯 <strong>What We'll Configure</strong></h2>
<p>In this part, we'll set up three critical Office 365 connectors and a transport rule:
1. <strong>Proofpoint Inbound Connector</strong> - Receives filtered email from Proofpoint
2. <strong>ProofPoint Outbound Connector</strong> - Sends outbound email through Proofpoint
3. <strong>SMTP Relay Connector</strong> - Allows internal systems to send email
4. <strong>ProofPoint Spam Bypass Rule</strong> - Prevents double-scanning of emails</p>
<hr />
<h2 id="mail-flow-architecture">🔄 <strong>Mail Flow Architecture</strong></h2>
<p>Understanding the mail flow is crucial before configuration:</p>
<div class="highlight"><pre><span></span><code>graph TB
    subgraph &quot;Internet&quot;
        EXT[External Sender]
        INT[Internal Apps/Printers]
    end

    subgraph &quot;Proofpoint Essentials&quot;
        PP[Proofpoint Filtering]
    end

    subgraph &quot;Office 365&quot;
        EOP[Exchange Online Protection]
        EXO[Exchange Online]
        USERS[User Mailboxes]
    end

    EXT --&gt; PP
    PP --&gt; EOP
    EOP --&gt; EXO
    EXO --&gt; USERS

    INT --&gt; EOP
    EXO --&gt; PP
    PP --&gt; EXT

    style PP fill:#ff6b6b
    style EOP fill:#4ecdc4
    style EXO fill:#45b7d1
</code></pre></div>
<hr />
<h2 id="prerequisites">🔑 <strong>Prerequisites</strong></h2>
<p>Before starting, ensure you have:
- [ ] Global Administrator access to Office 365
- [ ] Exchange Online Administrator permissions
- [ ] DNS records from Part 2 implemented and propagated
- [ ] Proofpoint IP address ranges (from Proofpoint documentation)</p>
<hr />
<h2 id="connector-1-proofpoint-inbound">📥 <strong>Connector 1: Proofpoint Inbound</strong></h2>
<p>This connector accepts filtered email from Proofpoint and is the most security-critical configuration.</p>
<h3 id="step-1-create-the-inbound-connector"><strong>Step 1: Create the Inbound Connector</strong></h3>
<ol>
<li><strong>Navigate to Exchange Admin Center</strong></li>
<li>Go to <a href="https://admin.exchange.microsoft.com">admin.exchange.microsoft.com</a></li>
<li>
<p>Sign in with Global Admin credentials</p>
</li>
<li>
<p><strong>Access Mail Flow Settings</strong></p>
</li>
<li>Click <strong>Mail flow</strong> in the left navigation</li>
<li>Select <strong>Connectors</strong></li>
<li>
<p>Click <strong>+ Add a connector</strong></p>
</li>
<li>
<p><strong>Configure Basic Settings</strong>
   <div class="highlight"><pre><span></span><code>Connection from: Partner organization
Connection to: Office 365
Name: Proofpoint Inbound connector
Description: Receives filtered email from Proofpoint Essentials
</code></pre></div></p>
</li>
</ol>
<h3 id="step-2-configure-partner-organization-identity"><strong>Step 2: Configure Partner Organization Identity</strong></h3>
<div class="highlight"><pre><span></span><code>How to identify your partner organization:
☑️ By verifying that messages are coming from these domains: *
</code></pre></div>
<blockquote>
<p><strong>Why use asterisk (*)</strong>: We want to accept email for ALL domains that might be processed by Proofpoint, not just our primary domain.</p>
</blockquote>
<h3 id="step-3-configure-security-restrictions"><strong>Step 3: Configure Security Restrictions</strong></h3>
<h4 id="tls-requirements"><strong>TLS Requirements:</strong></h4>
<div class="highlight"><pre><span></span><code>☑️ Reject messages if they aren&#39;t encrypted using Transport Layer Security (TLS)
</code></pre></div>
<h4 id="ip-address-restrictions"><strong>IP Address Restrictions:</strong></h4>
<div class="highlight"><pre><span></span><code>☑️ Reject messages if they don&#39;t come from within these IP address ranges:
67.231.149.0/24
67.231.148.0/24  
67.231.147.0/24
67.231.146.0/24
67.231.145.0/24
67.231.144.0/24
67.231.156.0/24
</code></pre></div>
<blockquote>
<p><strong>⚠️ Critical Security Note</strong>: Include ALL Proofpoint IP ranges from their documentation. The security of your email depends on this being complete and accurate.</p>
</blockquote>
<h3 id="step-4-apply-advanced-security-setting"><strong>Step 4: Apply Advanced Security Setting</strong></h3>
<p>After creating the connector, run this PowerShell command to prevent bypass attacks:</p>
<div class="highlight"><pre><span></span><code><span class="c"># Connect to Exchange Online PowerShell</span>
<span class="nb">Connect-ExchangeOnline</span>

<span class="c"># Enable the critical security setting</span>
<span class="nb">Set-InboundConnector</span> <span class="n">-Identity</span> <span class="s2">&quot;Proofpoint Inbound connector&quot;</span> <span class="n">-RestrictDomainsToIPAddresses</span> <span class="nv">$True</span>

<span class="c"># Verify the change was applied successfully</span>
<span class="nb">Get-InboundConnector</span> <span class="n">-Identity</span> <span class="s2">&quot;Proofpoint Inbound connector&quot;</span> <span class="p">|</span> <span class="nb">Select-Object</span> <span class="n">Name</span><span class="p">,</span> <span class="n">RestrictDomainsToIPAddresses</span>
</code></pre></div>
<h4 id="why-this-setting-matters"><strong>Why This Setting Matters:</strong></h4>
<ul>
<li><strong>Without it</strong>: Bad actors can send emails directly to your O365 endpoints, bypassing Proofpoint</li>
<li><strong>With it</strong>: Only emails from Proofpoint IP ranges are accepted, forcing all email through your security stack</li>
<li><strong>The Risk</strong>: It's easy for attackers to discover if an organization uses O365 and target the endpoints directly</li>
</ul>
<hr />
<h2 id="connector-2-proofpoint-outbound">📤 <strong>Connector 2: ProofPoint Outbound</strong></h2>
<p>This connector routes all outbound email through Proofpoint for scanning and protection.</p>
<h3 id="step-1-create-the-outbound-connector"><strong>Step 1: Create the Outbound Connector</strong></h3>
<ol>
<li><strong>In Exchange Admin Center</strong></li>
<li><strong>Mail flow</strong> &gt; <strong>Connectors</strong></li>
<li>
<p>Click <strong>+ Add a connector</strong></p>
</li>
<li>
<p><strong>Configure Basic Settings</strong>
   <div class="highlight"><pre><span></span><code>Connection from: Office 365
Connection to: Partner organization
Name: ProofPoint Outbound connector
Description: Routes outbound email through Proofpoint for filtering
</code></pre></div></p>
</li>
</ol>
<h3 id="step-2-configure-domain-scope"><strong>Step 2: Configure Domain Scope</strong></h3>
<div class="highlight"><pre><span></span><code>Use of connector: Use only for email sent to these domains: *
</code></pre></div>
<blockquote>
<p><strong>Why asterisk (*)</strong>: We want ALL outbound email to go through Proofpoint, regardless of destination domain.</p>
</blockquote>
<h3 id="step-3-configure-routing"><strong>Step 3: Configure Routing</strong></h3>
<div class="highlight"><pre><span></span><code>Route email messages through these smart hosts:
outbound-us1.ppe-hosted.com
</code></pre></div>
<blockquote>
<p><strong>Note</strong>: Your Proofpoint smart host may be different. Check your Proofpoint configuration for the correct outbound smart host address.</p>
</blockquote>
<h3 id="step-4-configure-security-settings"><strong>Step 4: Configure Security Settings</strong></h3>
<div class="highlight"><pre><span></span><code>☑️ Always use Transport Layer Security (TLS)
☑️ Connect only if the recipient&#39;s email server certificate is issued by a trusted certificate authority (CA)
</code></pre></div>
<hr />
<h2 id="connector-3-smtp-relay">🖥️ <strong>Connector 3: SMTP Relay</strong></h2>
<p>This connector allows internal systems (ERP, printers, scanners) to send email directly to Office 365.</p>
<h3 id="step-1-create-the-smtp-relay-connector"><strong>Step 1: Create the SMTP Relay Connector</strong></h3>
<ol>
<li><strong>In Exchange Admin Center</strong></li>
<li><strong>Mail flow</strong> &gt; <strong>Connectors</strong></li>
<li>
<p>Click <strong>+ Add a connector</strong></p>
</li>
<li>
<p><strong>Configure Basic Settings</strong>
   <div class="highlight"><pre><span></span><code>Connection from: Your organization&#39;s email server
Connection to: Office 365
Name: SMTP Relay
Description: Allows internal systems to send email directly to O365
</code></pre></div></p>
</li>
</ol>
<h3 id="step-2-configure-ip-address-authentication"><strong>Step 2: Configure IP Address Authentication</strong></h3>
<div class="highlight"><pre><span></span><code>How to identify email sent from your email server:
☑️ By verifying that the sending server&#39;s IP address is within these IP address ranges:

174.78.66.42
12.11.165.164
66.226.121.34
96.77.138.91
12.70.226.178
12.41.87.194
190.221.170.194
200.189.31.48
129.222.141.201
172.87.153.138
209.214.205.10
70.125.235.122
12.47.143.170
173.241.176.26
12.165.138.122
208.180.186.118
137.103.13.130
20.81.4.12
</code></pre></div>
<h3 id="step-3-additional-requirements"><strong>Step 3: Additional Requirements</strong></h3>
<div class="highlight"><pre><span></span><code>☑️ The sender&#39;s or recipient&#39;s email address is an accepted domain for your organization
</code></pre></div>
<h4 id="critical-connection"><strong>🔗 Critical Connection</strong>:</h4>
<p>Notice these IP addresses <strong>exactly match</strong> the ones in your DNS SPF records (_spf1 and _spf2 from Part 2). This alignment is essential because:</p>
<ul>
<li><strong>SPF records</strong> tell the world these IPs can send email for your domain</li>
<li><strong>SMTP Relay connector</strong> tells Office 365 to accept email from these same IPs</li>
<li><strong>Misalignment</strong> between these two configurations will cause email delivery failures</li>
</ul>
<hr />
<h2 id="transport-rule-proofpoint-spam-bypass">🛡️ <strong>Transport Rule: ProofPoint Spam Bypass</strong></h2>
<p>This rule prevents "double dipping" - where both Proofpoint and Exchange Online Protection scan the same email.</p>
<h3 id="step-1-create-the-transport-rule"><strong>Step 1: Create the Transport Rule</strong></h3>
<ol>
<li><strong>Navigate to Mail Flow Rules</strong></li>
<li><strong>Mail flow</strong> &gt; <strong>Rules</strong></li>
<li>
<p>Click <strong>+ Add a rule</strong></p>
</li>
<li>
<p><strong>Configure Basic Settings</strong>
   <div class="highlight"><pre><span></span><code>Name: ProofPoint Spam bypass
Description: Prevents double-scanning by setting SCL to -1 for Proofpoint-filtered emails
</code></pre></div></p>
</li>
</ol>
<h3 id="step-2-configure-conditions"><strong>Step 2: Configure Conditions</strong></h3>
<div class="highlight"><pre><span></span><code>Apply this rule if:
☑️ The sender IP address is in any of these ranges or exactly matches:

148.163.128.0/19
67.231.149.0/24
67.231.148.0/24
67.231.147.0/24
67.231.146.0/24
67.231.145.0/24
67.231.144.0/24
67.231.156.0/24
67.231.155.0/24
67.231.154.0/24
[... include all Proofpoint IP ranges]
</code></pre></div>
<h3 id="step-3-configure-actions"><strong>Step 3: Configure Actions</strong></h3>
<div class="highlight"><pre><span></span><code>Do the following:
☑️ Set the spam confidence level (SCL) to: -1
</code></pre></div>
<h3 id="step-4-configure-rule-settings"><strong>Step 4: Configure Rule Settings</strong></h3>
<div class="highlight"><pre><span></span><code>Rule mode: Enforce
Priority: 6
Severity: Not specified
</code></pre></div>
<h4 id="why-this-rule-is-essential"><strong>Why This Rule is Essential:</strong></h4>
<ul>
<li><strong>Without it</strong>: Emails are scanned by both Proofpoint AND Exchange Online Protection</li>
<li><strong>Problem</strong>: This can cause legitimate emails (already approved by Proofpoint) to be blocked by EOP</li>
<li><strong>Solution</strong>: SCL -1 tells EOP "this email is already clean, don't scan it again"</li>
</ul>
<hr />
<h2 id="configuration-verification">⚙️ <strong>Configuration Verification</strong></h2>
<h3 id="step-1-verify-connectors"><strong>Step 1: Verify Connectors</strong></h3>
<div class="highlight"><pre><span></span><code><span class="c"># Connect to Exchange Online PowerShell</span>
<span class="nb">Connect-ExchangeOnline</span>

<span class="c"># List all connectors</span>
<span class="nb">Get-InboundConnector</span> <span class="p">|</span> <span class="nb">Select-Object</span> <span class="n">Name</span><span class="p">,</span> <span class="n">Enabled</span><span class="p">,</span> <span class="n">ConnectorSource</span>
<span class="nb">Get-OutboundConnector</span> <span class="p">|</span> <span class="nb">Select-Object</span> <span class="n">Name</span><span class="p">,</span> <span class="n">Enabled</span><span class="p">,</span> <span class="n">SmartHosts</span>

<span class="c"># Verify the critical security setting</span>
<span class="nb">Get-InboundConnector</span> <span class="n">-Identity</span> <span class="s2">&quot;Proofpoint Inbound connector&quot;</span> <span class="p">|</span> 
    <span class="nb">Select-Object</span> <span class="n">Name</span><span class="p">,</span> <span class="n">RestrictDomainsToIPAddresses</span><span class="p">,</span> <span class="n">TlsSettings</span>
</code></pre></div>
<h3 id="step-2-verify-transport-rule"><strong>Step 2: Verify Transport Rule</strong></h3>
<div class="highlight"><pre><span></span><code><span class="c"># Check the transport rule</span>
<span class="nb">Get-TransportRule</span> <span class="n">-Identity</span> <span class="s2">&quot;ProofPoint Spam bypass&quot;</span> <span class="p">|</span> 
    <span class="nb">Select-Object</span> <span class="n">Name</span><span class="p">,</span> <span class="n">State</span><span class="p">,</span> <span class="n">Priority</span><span class="p">,</span> <span class="n">SetSCL</span>
</code></pre></div>
<h3 id="step-3-test-mail-flow"><strong>Step 3: Test Mail Flow</strong></h3>
<p>Before proceeding, conduct these basic tests:</p>
<ol>
<li><strong>Internal to Internal</strong>: Send email between internal users</li>
<li><strong>Outbound Test</strong>: Send email to external address</li>
<li><strong>Inbound Test</strong>: Have external party send email to you</li>
<li><strong>SMTP Relay Test</strong>: Send email from internal system (printer, etc.)</li>
</ol>
<hr />
<h2 id="critical-security-considerations">🚨 <strong>Critical Security Considerations</strong></h2>
<h3 id="ip-address-management"><strong>IP Address Management</strong></h3>
<ul>
<li><strong>Keep IP lists synchronized</strong> between DNS SPF records and O365 connectors</li>
<li><strong>Regular auditing</strong> - Remove IP addresses that are no longer in use</li>
<li><strong>Documentation</strong> - Maintain a record of what each IP address represents</li>
</ul>
<h3 id="connector-security"><strong>Connector Security</strong></h3>
<ul>
<li><strong>Never disable IP restrictions</strong> on the Proofpoint Inbound connector</li>
<li><strong>Monitor failed connections</strong> - Unexpected sources may indicate attacks</li>
<li><strong>Regular review</strong> of Proofpoint IP ranges for updates</li>
</ul>
<h3 id="transport-rule-priority"><strong>Transport Rule Priority</strong></h3>
<ul>
<li><strong>Keep spam bypass rule high priority</strong> (low number) to ensure it runs first</li>
<li><strong>Test rule effectiveness</strong> by checking message headers</li>
</ul>
<hr />
<h2 id="monitoring-and-maintenance">📊 <strong>Monitoring and Maintenance</strong></h2>
<h3 id="weekly-checks"><strong>Weekly Checks</strong></h3>
<ul>
<li>[ ] Review connector status in Exchange Admin Center</li>
<li>[ ] Check for any failed message delivery reports</li>
<li>[ ] Monitor transport rule hit counts</li>
</ul>
<h3 id="monthly-checks"><strong>Monthly Checks</strong></h3>
<ul>
<li>[ ] Verify Proofpoint IP ranges haven't changed</li>
<li>[ ] Review SMTP relay usage patterns</li>
<li>[ ] Update IP address lists if infrastructure changes</li>
</ul>
<h3 id="quarterly-checks"><strong>Quarterly Checks</strong></h3>
<ul>
<li>[ ] Full end-to-end mail flow testing</li>
<li>[ ] Review and update documentation</li>
<li>[ ] Security audit of connector configurations</li>
</ul>
<hr />
<h2 id="troubleshooting-common-issues">🔧 <strong>Troubleshooting Common Issues</strong></h2>
<h3 id="inbound-mail-issues"><strong>Inbound Mail Issues</strong></h3>
<p><strong>Problem</strong>: Legitimate emails being rejected
<div class="highlight"><pre><span></span><code>Error: &quot;550 5.7.64 TenantAttribution; Relay Access Denied&quot;
</code></pre></div>
<strong>Solution</strong>: 
1. Check if sender IP is in Proofpoint ranges
2. Verify <code>RestrictDomainsToIPAddresses</code> is set correctly
3. Check TLS configuration</p>
<p><strong>Problem</strong>: Emails being double-scanned
<div class="highlight"><pre><span></span><code>Symptom: Clean emails marked as spam
</code></pre></div>
<strong>Solution</strong>: 
1. Verify spam bypass rule is active and has correct IP ranges
2. Check rule priority (should be high priority/low number)
3. Review message headers for SCL values</p>
<h3 id="outbound-mail-issues"><strong>Outbound Mail Issues</strong></h3>
<p><strong>Problem</strong>: Outbound emails not being delivered
<div class="highlight"><pre><span></span><code>Error: &quot;451 4.4.0 DNS query failed&quot;
</code></pre></div>
<strong>Solution</strong>: 
1. Verify outbound smart host address
2. Check DNS resolution of smart host
3. Confirm Proofpoint outbound service is active</p>
<h3 id="smtp-relay-issues"><strong>SMTP Relay Issues</strong></h3>
<p><strong>Problem</strong>: Internal systems can't send email
<div class="highlight"><pre><span></span><code>Error: &quot;550 5.7.60 SMTP; Client does not have permissions to send as this sender&quot;
</code></pre></div>
<strong>Solution</strong>: 
1. Verify sender IP is in SMTP relay connector
2. Check if sender domain is accepted domain
3. Confirm connector is enabled</p>
<hr />
<h2 id="configuration-checklist">📋 <strong>Configuration Checklist</strong></h2>
<p>Before moving to Part 4, ensure:</p>
<h3 id="connectors-created"><strong>Connectors Created:</strong></h3>
<ul>
<li>[ ] Proofpoint Inbound connector configured with IP restrictions</li>
<li>[ ] Proofpoint Outbound connector routing to correct smart host</li>
<li>[ ] SMTP Relay connector with all internal IP addresses</li>
<li>[ ] All connectors are enabled and operational</li>
</ul>
<h3 id="security-settings-applied"><strong>Security Settings Applied:</strong></h3>
<ul>
<li>[ ] <code>RestrictDomainsToIPAddresses</code> set to <code>$True</code> on inbound connector</li>
<li>[ ] TLS required on all appropriate connectors</li>
<li>[ ] IP address ranges complete and accurate</li>
</ul>
<h3 id="transport-rules"><strong>Transport Rules:</strong></h3>
<ul>
<li>[ ] ProofPoint Spam bypass rule created and enabled</li>
<li>[ ] Rule includes all Proofpoint IP ranges</li>
<li>[ ] Rule priority set appropriately (recommend 1-10)</li>
<li>[ ] SCL set to -1 for Proofpoint sources</li>
</ul>
<h3 id="testing-completed"><strong>Testing Completed:</strong></h3>
<ul>
<li>[ ] Internal-to-internal email flow tested</li>
<li>[ ] Inbound email from external sources tested</li>
<li>[ ] Outbound email to external destinations tested</li>
<li>[ ] SMTP relay from internal systems tested</li>
</ul>
<hr />
<h2 id="common-mistakes-to-avoid">⚠️ <strong>Common Mistakes to Avoid</strong></h2>
<ol>
<li><strong>Incomplete IP Ranges</strong>: Not including all Proofpoint IP addresses</li>
<li><strong>Missing Security Setting</strong>: Forgetting to set <code>RestrictDomainsToIPAddresses</code></li>
<li><strong>Wrong Smart Host</strong>: Using incorrect outbound smart host address</li>
<li><strong>IP Address Mismatch</strong>: Having different IPs in SPF records vs. connectors</li>
<li><strong>Rule Priority Issues</strong>: Setting spam bypass rule too low priority</li>
<li><strong>Testing Shortcuts</strong>: Not testing all mail flow scenarios</li>
</ol>
<hr />
<h2 id="whats-next">🎯 <strong>What's Next</strong></h2>
<p>With Office 365 connectors configured, we'll move to <strong>Part 4</strong> where we'll set up the Proofpoint side of the integration, including:
- Domain relay configuration
- DKIM key generation and management
- Security feature enablement
- Email warning tag configuration</p>
<p>The connectors we've just configured will work hand-in-hand with the Proofpoint settings to create a seamless, secure email flow.</p>
<hr />
<h3 id="series-navigation_1">📖 <strong>Series Navigation</strong></h3>
<ul>
<li><a href="../email-o365-proofpoint-part2/">← Part 2: DNS Configuration and Setup</a></li>
<li><strong>Part 3: Office 365 Connector Configuration</strong> <em>(Current)</em></li>
<li><a href="../email-o365-proofpoint-part4/">Part 4: Proofpoint Integration Setup →</a></li>
</ul>
<hr />
<p><em>Always test connector changes during maintenance windows and monitor mail flow carefully for the first 24-48 hours after implementation.</em></p>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="August 14, 2025 18:46:46 UTC">August 14, 2025</span>
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections", "content.code.annotate", "content.code.copy"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="../assets/custom.js"></script>
      
    
  </body>
</html>