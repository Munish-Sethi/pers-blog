
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A professional blog showcasing business problem solutions with Python, Azure, and PowerShell examples.">
      
      
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="sample-article/">
      
      
      <link rel="icon" href="../None">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Certificate Based Auth 1 - Munish Sethi's Blog</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/custom.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#certificate-based-authentication-for-azure-ad-why-and-how" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Munish Sethi&#39;s Blog" class="md-header__button md-logo" aria-label="Munish Sethi's Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Munish Sethi's Blog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Certificate Based Auth 1
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Munish Sethi&#39;s Blog" class="md-nav__button md-logo" aria-label="Munish Sethi's Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Munish Sethi's Blog
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Azure AD
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Azure AD
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Certificate Based Auth 1
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Certificate Based Auth 1
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#creating-a-certificate-for-azure-ad-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Creating a Certificate for Azure AD Authentication
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Creating a Certificate for Azure AD Authentication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#steps-to-generate-a-certificate-using-openssl" class="md-nav__link">
    <span class="md-ellipsis">
      Steps to Generate a Certificate Using OpenSSL
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uploading-the-certificate-to-your-entra-azure-ad-application" class="md-nav__link">
    <span class="md-ellipsis">
      Uploading the Certificate to Your Entra (Azure AD) Application
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#assigning-permissions-to-the-application" class="md-nav__link">
    <span class="md-ellipsis">
      Assigning Permissions to the Application
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-use-a-certificate-instead-of-an-application-secret" class="md-nav__link">
    <span class="md-ellipsis">
      Why Use a Certificate Instead of an Application Secret?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Why Use a Certificate Instead of an Application Secret?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-security" class="md-nav__link">
    <span class="md-ellipsis">
      1. Security
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-lifecycle-management" class="md-nav__link">
    <span class="md-ellipsis">
      2. Lifecycle Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-compliance-and-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      3. Compliance and Best Practices
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-use-the-msal-library-and-not-a-specific-azure-sdk" class="md-nav__link">
    <span class="md-ellipsis">
      Why Use the MSAL Library (and Not a Specific Azure SDK)?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code-example-certificate-based-authentication-in-python" class="md-nav__link">
    <span class="md-ellipsis">
      Code Example: Certificate-Based Authentication in Python
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Code Example: Certificate-Based Authentication in Python">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key-points" class="md-nav__link">
    <span class="md-ellipsis">
      Key Points:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="sample-article/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sample Article
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#creating-a-certificate-for-azure-ad-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Creating a Certificate for Azure AD Authentication
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Creating a Certificate for Azure AD Authentication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#steps-to-generate-a-certificate-using-openssl" class="md-nav__link">
    <span class="md-ellipsis">
      Steps to Generate a Certificate Using OpenSSL
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uploading-the-certificate-to-your-entra-azure-ad-application" class="md-nav__link">
    <span class="md-ellipsis">
      Uploading the Certificate to Your Entra (Azure AD) Application
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#assigning-permissions-to-the-application" class="md-nav__link">
    <span class="md-ellipsis">
      Assigning Permissions to the Application
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-use-a-certificate-instead-of-an-application-secret" class="md-nav__link">
    <span class="md-ellipsis">
      Why Use a Certificate Instead of an Application Secret?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Why Use a Certificate Instead of an Application Secret?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-security" class="md-nav__link">
    <span class="md-ellipsis">
      1. Security
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-lifecycle-management" class="md-nav__link">
    <span class="md-ellipsis">
      2. Lifecycle Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-compliance-and-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      3. Compliance and Best Practices
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-use-the-msal-library-and-not-a-specific-azure-sdk" class="md-nav__link">
    <span class="md-ellipsis">
      Why Use the MSAL Library (and Not a Specific Azure SDK)?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code-example-certificate-based-authentication-in-python" class="md-nav__link">
    <span class="md-ellipsis">
      Code Example: Certificate-Based Authentication in Python
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Code Example: Certificate-Based Authentication in Python">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key-points" class="md-nav__link">
    <span class="md-ellipsis">
      Key Points:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="certificate-based-authentication-for-azure-ad-why-and-how">Certificate-Based Authentication for Azure AD: Why and How</h1>
<h2 id="creating-a-certificate-for-azure-ad-authentication">Creating a Certificate for Azure AD Authentication</h2>
<p>To use certificate-based authentication with Azure Active Directory (Azure AD), you first need to generate a certificate. Certificates provide a secure, manageable, and standards-based way to authenticate applications. A <code>.pfx</code> certificate may be required because Azure AD expects a certificate in Personal Information Exchange (PFX) format when uploading via the portal or for certain SDKs. The <code>.pfx</code> file contains both the public and private keys, protected by a password, and is suitable for import/export scenarios.</p>
<h3 id="steps-to-generate-a-certificate-using-openssl">Steps to Generate a Certificate Using OpenSSL</h3>
<ol>
<li><strong>Generate a Private Key:</strong>
   <code>sh
   openssl genrsa -out my-app-auth.key 2048</code></li>
<li><strong>Create a Certificate Signing Request (CSR):</strong>
   <code>sh
   openssl req -new -key my-app-auth.key -out my-app-auth.csr</code></li>
<li><strong>Generate a Self-Signed Certificate:</strong>
   <code>sh
   openssl x509 -req -days 730 -in my-app-auth.csr -signkey my-app-auth.key -out my-app-auth.crt</code></li>
<li><strong>Export to PFX (if needed for Azure):</strong>
   <code>sh
   openssl pkcs12 -export -out my-app-auth.pfx -inkey my-app-auth.key -in my-app-auth.crt</code><blockquote>
<p><strong>Note:</strong> The <code>.pfx</code> format is required if you want to upload the certificate via the Azure Portal or use it with some SDKs/tools. The <code>.crt</code> file is the public certificate, and the <code>.key</code> file is your private key (keep it secure!).</p>
</blockquote>
</li>
</ol>
<hr />
<h2 id="uploading-the-certificate-to-your-entra-azure-ad-application">Uploading the Certificate to Your Entra (Azure AD) Application</h2>
<ol>
<li>Go to the <a href="https://entra.microsoft.com/">Microsoft Entra admin center</a> and select <strong>Azure Active Directory</strong>.</li>
<li>Navigate to <strong>App registrations</strong> and select your application.</li>
<li>In the left menu, click <strong>Certificates &amp; secrets</strong>.</li>
<li>Under <strong>Certificates</strong>, click <strong>Upload certificate</strong>.</li>
<li>Select your <code>.crt</code> or <code>.pfx</code> file and upload it.</li>
<li>After uploading, Azure will display the certificate thumbprint. Save this value for use in your application code.</li>
</ol>
<hr />
<h2 id="assigning-permissions-to-the-application">Assigning Permissions to the Application</h2>
<p>After uploading the certificate, you must assign the necessary API permissions to your application:</p>
<ol>
<li>In your application's <strong>App registration</strong> page, go to <strong>API permissions</strong>.</li>
<li>Click <strong>Add a permission</strong> and select the required Microsoft APIs (e.g., Microsoft Graph, Azure Service Management, etc.).</li>
<li>Choose the appropriate permission type (Application or Delegated) and select the required permissions.</li>
<li>Click <strong>Add permissions</strong>.</li>
<li>If required, click <strong>Grant admin consent</strong> to approve the permissions for your organization.</li>
</ol>
<blockquote>
<p><strong>Note:</strong> The application will only be able to access resources for which it has been granted permissions. Make sure to review and assign only the permissions your app needs.</p>
</blockquote>
<hr />
<h2 id="why-use-a-certificate-instead-of-an-application-secret">Why Use a Certificate Instead of an Application Secret?</h2>
<h3 id="1-security">1. <strong>Security</strong></h3>
<ul>
<li><strong>Application secrets</strong> are essentially passwords. They are susceptible to accidental exposure (e.g., in code repositories, logs, or configuration files).</li>
<li><strong>Certificates</strong> use asymmetric cryptography. The private key never leaves your environment, and only the public key is uploaded to Azure AD. This makes certificates much harder to compromise.</li>
</ul>
<h3 id="2-lifecycle-management">2. <strong>Lifecycle Management</strong></h3>
<ul>
<li><strong>Secrets</strong> typically expire every 6-12 months, requiring regular rotation and updates in all dependent systems.</li>
<li><strong>Certificates</strong> can have longer lifespans (e.g., 1-2 years), and their expiration is easier to track and automate.</li>
</ul>
<h3 id="3-compliance-and-best-practices">3. <strong>Compliance and Best Practices</strong></h3>
<ul>
<li>Microsoft and most security frameworks recommend certificates for service-to-service authentication.</li>
<li>Certificates support better auditing and can be managed centrally (e.g., via Azure Key Vault).</li>
</ul>
<hr />
<h2 id="why-use-the-msal-library-and-not-a-specific-azure-sdk">Why Use the MSAL Library (and Not a Specific Azure SDK)?</h2>
<p>The <a href="https://github.com/AzureAD/microsoft-authentication-library-for-python">MSAL (Microsoft Authentication Library) for Python</a> is a lightweight, flexible library for acquiring tokens from Azure AD. It supports a wide range of authentication scenarios, including certificate-based authentication for confidential clients.</p>
<ul>
<li><strong>Why MSAL?</strong></li>
<li>MSAL is the official library for handling authentication and token acquisition with Azure AD.</li>
<li>It is not tied to a specific Azure service, making it ideal for generic authentication scenarios.</li>
<li>
<p>It supports advanced scenarios like certificate-based authentication, multi-tenant apps, and more.</p>
</li>
<li>
<p><strong>Why Not Use a Specific Azure SDK?</strong></p>
</li>
<li>Some Azure SDKs (e.g., for Storage, Key Vault, etc.) provide their own authentication mechanisms, but they may not support all advanced scenarios or may require additional dependencies.</li>
<li>Using MSAL directly gives you full control over the authentication flow and token management, and is more transparent for troubleshooting and customization.</li>
</ul>
<hr />
<h2 id="code-example-certificate-based-authentication-in-python">Code Example: Certificate-Based Authentication in Python</h2>
<p>Below is the function used in this project to acquire an Azure AD access token using a certificate:</p>
<pre><code class="language-python">from msal import ConfidentialClientApplication

def get_access_token_from_azure(client_id, authority, tenant_id, resource_scopes):
    &quot;&quot;&quot;
    Retrieves an access token from Azure Active Directory using a confidential client application.
    This function uses certificate-based authentication to acquire an access token for the specified resource.
    &quot;&quot;&quot;
    try:
        with open(f&quot;certs/{PFX_CERTIFICATE_NAME}.key&quot;, &quot;r&quot;) as key_file:
            private_key = key_file.read()

        app = ConfidentialClientApplication(
            client_id=client_id,
            authority=f&quot;{authority}{tenant_id}&quot;,
            client_credential={
                &quot;thumbprint&quot;: PFX_CERTIFICATE_NAME_TP,
                &quot;private_key&quot;: private_key,
            },
        )

        result = app.acquire_token_for_client(scopes=resource_scopes)
        if &quot;access_token&quot; in result:
            return result[&quot;access_token&quot;]

    except Exception as exception:
        handle_global_exception(sys._getframe().f_code.co_name, exception)
    finally:
        pass
</code></pre>
<h3 id="key-points">Key Points:</h3>
<ul>
<li>The private key is read from a secure file (<code>certs/*.key</code>).</li>
<li>The certificate thumbprint and private key are passed to MSAL's <code>ConfidentialClientApplication</code>.</li>
<li>No secrets or passwords are stored in code or configuration.</li>
</ul>
<hr />
<h2 id="conclusion">Conclusion</h2>
<p><strong>Certificate-based authentication</strong> is the recommended and most secure way to authenticate service applications with Azure AD. It reduces risk, simplifies management, and aligns with industry best practices. Migrating from secrets to certificates is straightforward and well-supported by both Azure and the MSAL Python library.</p>
<hr />
<h2 id="references">References</h2>
<ul>
<li><a href="https://github.com/AzureAD/microsoft-authentication-library-for-python/tree/dev/sample">MSAL Python Certificate Auth Sample</a></li>
<li><a href="https://learn.microsoft.com/en-us/azure/active-directory/develop/app-objects-and-service-principals">Azure AD App Registration: Certificates &amp; Secrets</a></li>
<li><a href="https://www.openssl.org/docs/">OpenSSL Documentation</a></li>
</ul>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="June 7, 2025 18:10:12">June 7, 2025</span>
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections", "content.code.annotate", "content.code.copy"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="../assets/custom.js"></script>
      
    
  </body>
</html>