
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A professional blog showcasing business problem solutions.">
      
      
      
        <link rel="canonical" href="https://munishsethi.com/meraki-nagios-device-sync/">
      
      
        <link rel="prev" href="../meraki-unused-device-sync/">
      
      
        <link rel="next" href="../monitoring-itsm-integration/">
      
      
      <link rel="icon" href="../None">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>Cisco Meraki Devices Discovery and Nagios Integration - Munish(s) Blog</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e37652d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/custom.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#automating-cisco-meraki-device-discovery-and-nagios-xi-monitoring-integration" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Munish(s) Blog" class="md-header__button md-logo" aria-label="Munish(s) Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Munish(s) Blog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Cisco Meraki Devices Discovery and Nagios Integration
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Munish(s) Blog" class="md-nav__button md-logo" aria-label="Munish(s) Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Munish(s) Blog
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Azure
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Azure
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-ad-certificate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate Based Authentication
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-billing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Download Azure Bill
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Download Azure Resource
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-query-recovery-services-vault/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Query Recovery Services Vault
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-ad-user/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Entra Users, User Groups and Licence assignments
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-ad-user-devices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Entra User Devices
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-container-schedule/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Orchestrating Scheduled Jobs (Container Instances)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../devops-build-container/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DevOps Build Container
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../devops-deploy-container-iac/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DevOps Deploy Container IaC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../devops-deploy-container-github-action/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DevOps Deploy Container Github Actions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../avd-custon-image-compute-gallery-part1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Building and Publishing an Custom Image
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../avd-publish-part2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deploying Azure Virtual Desktop (AVD) Desktops
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../avd-cleanup-obsolete-fsLogix-profiles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cleanup Obsolete FXLogix Profiles(AVD)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-bcpdr-part1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Business Coninuity Program / Diasister Recovery - Part 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-bcpdr-part2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Business Continuity Program / Disaster Recovery - Part 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-bcpdr-github-action/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Business Continuity Program / Disaster Recovery - Git Hub Action
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-restore-from-backup-part1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Restore VM from RSV Backup - Part 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-restore-from-backup-part2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Restore VM from RSV Backup - Part 2
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Fabric
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Fabric
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fabric-wharehouse-fact-import/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Warehouse data import
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Cisco Meraki, Nagios XI & Manage Engine
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Cisco Meraki, Nagios XI & Manage Engine
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../meraki-unused-device-sync/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cisco Meraki Unused Devices
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Cisco Meraki Devices Discovery and Nagios Integration
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Cisco Meraki Devices Discovery and Nagios Integration
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#required-python-libraries" class="md-nav__link">
    <span class="md-ellipsis">
      Required Python Libraries
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-authenticating-to-cisco-meraki-and-nagios-xi-apis" class="md-nav__link">
    <span class="md-ellipsis">
      1. Authenticating to Cisco Meraki and Nagios XI APIs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Authenticating to Cisco Meraki and Nagios XI APIs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cisco-meraki-api-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Cisco Meraki API Authentication
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nagios-xi-api-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Nagios XI API Authentication
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1a-understanding-and-setting-up-meraki_dashboard_snmp_community_string" class="md-nav__link">
    <span class="md-ellipsis">
      1a. Understanding and Setting Up MERAKI_DASHBOARD_SNMP_COMMUNITY_STRING
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1a. Understanding and Setting Up MERAKI_DASHBOARD_SNMP_COMMUNITY_STRING">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-meraki_dashboard_snmp_community_string" class="md-nav__link">
    <span class="md-ellipsis">
      What is MERAKI_DASHBOARD_SNMP_COMMUNITY_STRING?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-set-up-the-snmp-community-string-in-meraki-dashboard" class="md-nav__link">
    <span class="md-ellipsis">
      How to Set Up the SNMP Community String in Meraki Dashboard
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plugging-the-community-string-into-your-code" class="md-nav__link">
    <span class="md-ellipsis">
      Plugging the Community String into Your Code
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-obtaining-all-current-devices-from-meraki" class="md-nav__link">
    <span class="md-ellipsis">
      2. Obtaining All Current Devices from Meraki
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-obtaining-meraki-hostnames-via-snmp-oid" class="md-nav__link">
    <span class="md-ellipsis">
      3. Obtaining Meraki Hostnames via SNMP OID
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-checking-firmware-status-for-each-network" class="md-nav__link">
    <span class="md-ellipsis">
      4. Checking Firmware Status for Each Network
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Checking Firmware Status for Each Network">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-getnetworkfirmwareupgrades" class="md-nav__link">
    <span class="md-ellipsis">
      What is getNetworkFirmwareUpgrades?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Example Usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Example Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sample-output-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Sample Output Structure
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-comparing-meraki-devices-to-nagios-xi-hosts" class="md-nav__link">
    <span class="md-ellipsis">
      5. Comparing Meraki Devices to Nagios XI Hosts
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-adding-missing-devices-to-nagios-xi" class="md-nav__link">
    <span class="md-ellipsis">
      6. Adding Missing Devices to Nagios XI
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-applying-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      7. Applying Configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-full-function-code-add_missing_network_device_to_nagios" class="md-nav__link">
    <span class="md-ellipsis">
      8. Full Function Code: add_missing_network_device_to_nagios
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      9. Conclusion
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../monitoring-itsm-integration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Integrating Monitoring System with ITSM System
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../meraki-vm-deployment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deploying Cisco Meraki vMX
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Active Directory Domain Services
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Active Directory Domain Services
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adds-user-creation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Create ADDS User
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adds-user-update/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Update ADDS User
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    SAP
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            SAP
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sap-rfc-python-container/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Setup PyRFC in your Container
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sap-rfc-python/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Calling SAP RFC Function Modules from Python
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sap-system-start-stop/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Automating SAP System Start/Stop Operations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    O365
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            O365
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adaptive-card-consultant-review-part1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Outlook Actionable Adaptive Card - Part 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adaptive-card-consultant-review-part2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Outlook Actionable Adaptive Card - Part 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sharepoint-sites-enumeration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sharepoint Sites Enumeration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sharepoint-site-library-enumeration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sharepoint Document Library Enumeration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sharepoint-site-library-to-azure-fileshare/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Migrate Sharepoint Document Library to Azure File Share
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sap-concur-expense-reports-aggregation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Concur Expense Report Aggregation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../teams-user-number-assignment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Get all Teams Phone Assignment(s)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../deprovision-user/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deprovison User
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tenantallowblocklist/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tenant Allow Block List - False Positive
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../email-o365-proofpoint-part1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    O365 and Proof Point Essentials - Part 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../email-o365-proofpoint-part2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    O365 and Proof Point Essentials - Part 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../email-o365-proofpoint-part3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    O365 and Proof Point Essentials - Part 3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../email-o365-proofpoint-part4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    O365 and Proof Point Essentials - Part 4
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../email-o365-proofpoint-part5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    O365 and Proof Point Essentials - Part 5
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    UKG
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            UKG
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ukg-sftp-file-transfer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Secure File Transfer with UKG Dimensions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ukg-api-employee-verification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Employee Verification via API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ukg-api-integration-and-dataview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Automating Integration Execution and Dataview extract
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Misc
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Misc
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../proofpoint-user-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Proof Point User Management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../github-clean-deployments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Clean GitHub Deployments
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../proofpointo365connector/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Understanding DMARC/Spoofing, O365 with ProofPoint
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#required-python-libraries" class="md-nav__link">
    <span class="md-ellipsis">
      Required Python Libraries
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-authenticating-to-cisco-meraki-and-nagios-xi-apis" class="md-nav__link">
    <span class="md-ellipsis">
      1. Authenticating to Cisco Meraki and Nagios XI APIs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Authenticating to Cisco Meraki and Nagios XI APIs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cisco-meraki-api-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Cisco Meraki API Authentication
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nagios-xi-api-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Nagios XI API Authentication
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1a-understanding-and-setting-up-meraki_dashboard_snmp_community_string" class="md-nav__link">
    <span class="md-ellipsis">
      1a. Understanding and Setting Up MERAKI_DASHBOARD_SNMP_COMMUNITY_STRING
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1a. Understanding and Setting Up MERAKI_DASHBOARD_SNMP_COMMUNITY_STRING">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-meraki_dashboard_snmp_community_string" class="md-nav__link">
    <span class="md-ellipsis">
      What is MERAKI_DASHBOARD_SNMP_COMMUNITY_STRING?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-set-up-the-snmp-community-string-in-meraki-dashboard" class="md-nav__link">
    <span class="md-ellipsis">
      How to Set Up the SNMP Community String in Meraki Dashboard
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plugging-the-community-string-into-your-code" class="md-nav__link">
    <span class="md-ellipsis">
      Plugging the Community String into Your Code
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-obtaining-all-current-devices-from-meraki" class="md-nav__link">
    <span class="md-ellipsis">
      2. Obtaining All Current Devices from Meraki
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-obtaining-meraki-hostnames-via-snmp-oid" class="md-nav__link">
    <span class="md-ellipsis">
      3. Obtaining Meraki Hostnames via SNMP OID
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-checking-firmware-status-for-each-network" class="md-nav__link">
    <span class="md-ellipsis">
      4. Checking Firmware Status for Each Network
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Checking Firmware Status for Each Network">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-getnetworkfirmwareupgrades" class="md-nav__link">
    <span class="md-ellipsis">
      What is getNetworkFirmwareUpgrades?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Example Usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Example Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sample-output-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Sample Output Structure
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-comparing-meraki-devices-to-nagios-xi-hosts" class="md-nav__link">
    <span class="md-ellipsis">
      5. Comparing Meraki Devices to Nagios XI Hosts
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-adding-missing-devices-to-nagios-xi" class="md-nav__link">
    <span class="md-ellipsis">
      6. Adding Missing Devices to Nagios XI
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-applying-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      7. Applying Configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-full-function-code-add_missing_network_device_to_nagios" class="md-nav__link">
    <span class="md-ellipsis">
      8. Full Function Code: add_missing_network_device_to_nagios
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      9. Conclusion
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="automating-cisco-meraki-device-discovery-and-nagios-xi-monitoring-integration">Automating Cisco Meraki Device Discovery and Nagios XI Monitoring Integration</h1>
<h2 id="introduction">Introduction</h2>
<p>Keeping your network monitoring system in sync with your actual device inventory is critical for reliable operations. This article provides a deep dive into a robust Python workflow that:</p>
<ul>
<li>Discovers all current devices from the Cisco Meraki cloud API</li>
<li>Uses SNMP OIDs to obtain Meraki hostnames</li>
<li>Compares Meraki inventory to Nagios XI monitored hosts</li>
<li>Adds missing devices to Nagios XI, including handling special device types</li>
<li>Checks firmware status for compliance</li>
</ul>
<p>All code is provided and explained so you can adapt this solution for your own environment.</p>
<hr />
<h2 id="required-python-libraries">Required Python Libraries</h2>
<p>This workflow uses the following Python libraries:</p>
<ul>
<li><strong>meraki</strong>: Official Cisco Meraki Dashboard API Python library. Used for all Meraki cloud API calls.</li>
<li><strong>requests</strong>: For making HTTP requests to the Nagios XI REST API.</li>
<li><strong>subprocess</strong>: To run SNMP commands (e.g., <code>snmpwalk</code>) from Python.</li>
<li><strong>re</strong>: For parsing SNMP command output with regular expressions.</li>
</ul>
<p>Install any missing libraries with pip:</p>
<div class="highlight"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>meraki<span class="w"> </span>requests
</code></pre></div>
<hr />
<h2 id="1-authenticating-to-cisco-meraki-and-nagios-xi-apis">1. Authenticating to Cisco Meraki and Nagios XI APIs</h2>
<h3 id="cisco-meraki-api-authentication">Cisco Meraki API Authentication</h3>
<p>To connect to the Meraki Dashboard API, you need an API key. This key can be generated in your Meraki dashboard under <strong>Organization &gt; Settings &gt; Dashboard API access</strong>.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">meraki</span>

<span class="n">MERAKI_API_KEY</span> <span class="o">=</span> <span class="s1">&#39;YOUR_MERAKI_API_KEY&#39;</span>  <span class="c1"># Replace with your Meraki API key</span>
<span class="n">MERAKI_BASE_URL</span> <span class="o">=</span> <span class="s1">&#39;https://api.meraki.com/api/v1/&#39;</span>

<span class="n">dashboard</span> <span class="o">=</span> <span class="n">meraki</span><span class="o">.</span><span class="n">DashboardAPI</span><span class="p">(</span>
    <span class="n">api_key</span><span class="o">=</span><span class="n">MERAKI_API_KEY</span><span class="p">,</span>
    <span class="n">base_url</span><span class="o">=</span><span class="n">MERAKI_BASE_URL</span><span class="p">,</span>
    <span class="n">output_log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">print_console</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">suppress_logging</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</code></pre></div>
<h3 id="nagios-xi-api-authentication">Nagios XI API Authentication</h3>
<p>Nagios XI provides a REST API. You need an API key, which can be generated in the Nagios XI web interface under <strong>My Account &gt; API Keys</strong>.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>

<span class="n">NAGIOS_XI_API_URL</span> <span class="o">=</span> <span class="s1">&#39;https://your-nagios-server.example.com/nagiosxi/api/v1/&#39;</span>  <span class="c1"># Replace with your Nagios XI URL</span>
<span class="n">NAGIOS_XI_API_KEY</span> <span class="o">=</span> <span class="s1">&#39;YOUR_NAGIOS_API_KEY&#39;</span>  <span class="c1"># Replace with your Nagios XI API key</span>

<span class="k">def</span><span class="w"> </span><span class="nf">call_nagios_api</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">NAGIOS_XI_API_URL</span><span class="si">}{</span><span class="n">endpoint</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Authorization&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;Bearer </span><span class="si">{</span><span class="n">NAGIOS_XI_API_KEY</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">}</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;PUT&#39;</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;DELETE&#39;</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unsupported HTTP method&#39;</span><span class="p">)</span>
    <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre></div>
<hr />
<h2 id="1a-understanding-and-setting-up-meraki_dashboard_snmp_community_string">1a. Understanding and Setting Up <code>MERAKI_DASHBOARD_SNMP_COMMUNITY_STRING</code></h2>
<h3 id="what-is-meraki_dashboard_snmp_community_string">What is <code>MERAKI_DASHBOARD_SNMP_COMMUNITY_STRING</code>?</h3>
<p>The <code>MERAKI_DASHBOARD_SNMP_COMMUNITY_STRING</code> is a shared secret (like a password) used for authenticating SNMP v2c queries to the Meraki cloud SNMP endpoint. It is required to retrieve device information via SNMP, such as hostnames and other device attributes.</p>
<h3 id="how-to-set-up-the-snmp-community-string-in-meraki-dashboard">How to Set Up the SNMP Community String in Meraki Dashboard</h3>
<ol>
<li><strong>Log in to your Meraki Dashboard</strong></li>
<li>Navigate to <strong>Organization &gt; Settings</strong></li>
<li>Scroll to the <strong>SNMP</strong> section</li>
<li>Enable <strong>Cloud Monitoring</strong> (SNMP v2c)</li>
<li>Set your desired <strong>SNMP Community String</strong> (e.g., <code>mysnmpcommunity</code>)</li>
<li>Save your changes</li>
<li><strong>Whitelist your public IP address</strong> in the SNMP section to allow SNMP queries from your monitoring server</li>
</ol>
<blockquote>
<p><strong>Note:</strong> The SNMP community string acts as a password for SNMP v2c. Keep it secure and do not share it publicly.</p>
</blockquote>
<h3 id="plugging-the-community-string-into-your-code">Plugging the Community String into Your Code</h3>
<p>In your Python code, set the value as follows:</p>
<div class="highlight"><pre><span></span><code><span class="n">MERAKI_DASHBOARD_SNMP_COMMUNITY_STRING</span> <span class="o">=</span> <span class="s1">&#39;mysnmpcommunity&#39;</span>  <span class="c1"># Replace with your actual SNMP community string</span>
</code></pre></div>
<p>This value is then used in SNMP queries, for example:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_snmp_data</span><span class="p">(</span><span class="n">snmp_server</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">oid</span><span class="p">,</span> <span class="n">community</span><span class="p">):</span>
    <span class="n">command</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;snmpwalk&quot;</span><span class="p">,</span>
        <span class="s2">&quot;-v&quot;</span><span class="p">,</span> <span class="s2">&quot;2c&quot;</span><span class="p">,</span>
        <span class="s2">&quot;-c&quot;</span><span class="p">,</span> <span class="n">community</span><span class="p">,</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">snmp_server</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">port</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">oid</span>
    <span class="p">]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span>
        <span class="n">snmp_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(\S+)\s+=\s+STRING:\s+&quot;([^&quot;]+)&quot;&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">pattern</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">output</span><span class="p">):</span>
            <span class="n">oid</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">string_value</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">snmp_dict</span><span class="p">[</span><span class="n">string_value</span><span class="p">]</span> <span class="o">=</span> <span class="n">oid</span>
        <span class="k">return</span> <span class="n">snmp_dict</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SNMP error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

<span class="n">MERAKI_DASHBOARD_SNMP_HOST_NAME</span> <span class="o">=</span> <span class="s1">&#39;snmp.meraki.com&#39;</span>
<span class="n">MERAKI_DASHBOARD_SNMP_PORT</span> <span class="o">=</span> <span class="s1">&#39;16100&#39;</span>

<span class="n">merakihostnames</span> <span class="o">=</span> <span class="n">get_snmp_data</span><span class="p">(</span>
    <span class="n">MERAKI_DASHBOARD_SNMP_HOST_NAME</span><span class="p">,</span>
    <span class="n">MERAKI_DASHBOARD_SNMP_PORT</span><span class="p">,</span>
    <span class="s1">&#39;1.3.6.1.4.1.29671.1.1.4.1.2&#39;</span><span class="p">,</span>
    <span class="n">MERAKI_DASHBOARD_SNMP_COMMUNITY_STRING</span>
<span class="p">)</span>
</code></pre></div>
<p>If you change the community string in the Meraki dashboard, update it in your code as well.</p>
<hr />
<h2 id="2-obtaining-all-current-devices-from-meraki">2. Obtaining All Current Devices from Meraki</h2>
<p>We use the official Meraki Dashboard API to fetch all organizations, devices, and networks:</p>
<p><div class="highlight"><pre><span></span><code><span class="n">gdepOrganizations</span> <span class="o">=</span> <span class="n">dashboard</span><span class="o">.</span><span class="n">organizations</span><span class="o">.</span><span class="n">getOrganizations</span><span class="p">()</span>
<span class="n">organizationid</span> <span class="o">=</span> <span class="n">gdepOrganizations</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
<span class="n">gdepdevices</span> <span class="o">=</span> <span class="n">dashboard</span><span class="o">.</span><span class="n">organizations</span><span class="o">.</span><span class="n">getOrganizationDevices</span><span class="p">(</span><span class="n">organizationid</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">gdepnetworks</span> <span class="o">=</span> <span class="n">dashboard</span><span class="o">.</span><span class="n">organizations</span><span class="o">.</span><span class="n">getOrganizationNetworks</span><span class="p">(</span><span class="n">organizationid</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
- <code>getOrganizations()</code> returns all organizations your API key can access.
- <code>getOrganizationDevices()</code> fetches all devices (appliances, switches, cameras, wireless, etc.).
- <code>getOrganizationNetworks()</code> fetches all networks (logical groupings of devices).</p>
<hr />
<h2 id="3-obtaining-meraki-hostnames-via-snmp-oid">3. Obtaining Meraki Hostnames via SNMP OID</h2>
<p>To get hostnames as seen by Meraki's SNMP dashboard, we use the SNMP OID <code>1.3.6.1.4.1.29671.1.1.4.1.2</code> (see code above).</p>
<ul>
<li>This function runs an <code>snmpwalk</code> command and parses the output into a dictionary of hostnames and OIDs.</li>
<li>SNMP access must be enabled and your IP whitelisted in the Meraki dashboard.</li>
</ul>
<hr />
<h2 id="4-checking-firmware-status-for-each-network">4. Checking Firmware Status for Each Network</h2>
<p>For each network, we check the current firmware status of all products using the Meraki Dashboard API's <code>getNetworkFirmwareUpgrades</code> method.</p>
<h3 id="what-is-getnetworkfirmwareupgrades">What is <code>getNetworkFirmwareUpgrades</code>?</h3>
<p>This method retrieves the current and available firmware versions for all devices in a given Meraki network. It helps you:
- Audit firmware compliance
- Identify devices that need upgrades
- Track which products are running which firmware</p>
<h3 id="example-usage">Example Usage</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># For each network, get firmware upgrade status</span>
<span class="k">for</span> <span class="n">network</span> <span class="ow">in</span> <span class="n">gdepnetworks</span><span class="p">:</span>
    <span class="n">network_id</span> <span class="o">=</span> <span class="n">network</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
    <span class="n">networkupgrades</span> <span class="o">=</span> <span class="n">dashboard</span><span class="o">.</span><span class="n">networks</span><span class="o">.</span><span class="n">getNetworkFirmwareUpgrades</span><span class="p">(</span><span class="n">network_id</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Firmware info for network </span><span class="si">{</span><span class="n">network</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">networkupgrades</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;products&#39;</span> <span class="ow">in</span> <span class="n">networkupgrades</span><span class="p">:</span>
        <span class="n">products</span> <span class="o">=</span> <span class="n">networkupgrades</span><span class="p">[</span><span class="s1">&#39;products&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">product_type</span><span class="p">,</span> <span class="n">firmware_info</span> <span class="ow">in</span> <span class="n">products</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Product: </span><span class="si">{</span><span class="n">product_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Current Version: </span><span class="si">{</span><span class="n">firmware_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;currentVersion&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Available Version: </span><span class="si">{</span><span class="n">firmware_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;availableVersion&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status: </span><span class="si">{</span><span class="n">firmware_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<h4 id="sample-output-structure">Sample Output Structure</h4>
<p>The returned dictionary typically looks like:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;products&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;appliance&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;currentVersion&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MX 18.107.2&quot;</span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;availableVersion&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MX 18.107.4&quot;</span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Up to date&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;switch&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;currentVersion&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MS 15.21&quot;</span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;availableVersion&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MS 15.22&quot;</span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Upgrade available&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li><code>currentVersion</code>: The firmware currently running on the product type.</li>
<li><code>availableVersion</code>: The latest available firmware for that product type.</li>
<li><code>status</code>: Whether the device is up to date or needs an upgrade.</li>
</ul>
<p>This information can be used to automate firmware compliance checks and trigger upgrades as needed.</p>
<hr />
<h2 id="5-comparing-meraki-devices-to-nagios-xi-hosts">5. Comparing Meraki Devices to Nagios XI Hosts</h2>
<p>We fetch all hosts from Nagios XI and compare them to the Meraki inventory:</p>
<p><div class="highlight"><pre><span></span><code><span class="n">nagioshost</span> <span class="o">=</span> <span class="n">call_nagios_api</span><span class="p">(</span><span class="s1">&#39;objects/host&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">device</span> <span class="ow">in</span> <span class="n">gdepdevices</span><span class="p">:</span>
    <span class="n">nagioshostitems</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">nh</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">nh</span><span class="p">[</span><span class="s1">&#39;host_name&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">device</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">nagioshost</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nagioshostitems</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># Device is missing from Nagios XI</span>
        <span class="c1"># ...add to missing list and prepare for addition...</span>
</code></pre></div>
- Devices not found in Nagios XI are flagged for addition.
- Special handling for device types (appliance, switch, camera, wireless, etc.).</p>
<hr />
<h2 id="6-adding-missing-devices-to-nagios-xi">6. Adding Missing Devices to Nagios XI</h2>
<p>For each missing device, we call helper functions to create/update hosts and services in Nagios XI:</p>
<p><div class="highlight"><pre><span></span><code><span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">device</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">device</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">SKIP_MERAKI_HOSTS</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">device</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">SKIP_MERAKI_HOSTS</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">device</span><span class="p">[</span><span class="s1">&#39;productType&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;appliance&#39;</span> <span class="ow">and</span> <span class="s1">&#39;VMX&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">device</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]):</span>
                <span class="n">applianceVLANs</span> <span class="o">=</span> <span class="n">dashboard</span><span class="o">.</span><span class="n">appliance</span><span class="o">.</span><span class="n">getNetworkApplianceVlans</span><span class="p">(</span><span class="n">device</span><span class="p">[</span><span class="s1">&#39;networkId&#39;</span><span class="p">])</span>
                <span class="n">vlan999</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">av</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">av</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;999&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">applianceVLANs</span><span class="p">))</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vlan999</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">device</span><span class="p">[</span><span class="s1">&#39;lanIp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;0.0.0.0&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">device</span><span class="p">[</span><span class="s1">&#39;lanIp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vlan999</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;applianceIp&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">device</span><span class="p">[</span><span class="s1">&#39;lanIp&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">device</span><span class="p">[</span><span class="s1">&#39;lanIp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;0.0.0.0&#39;</span>
            <span class="n">create_update_meraki_host</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">nagioshostitems</span><span class="p">,</span> <span class="n">gdepnetworks</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">nagiosserviceitems</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">ns</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">[</span><span class="s1">&#39;host_name&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">device</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">nagioshostservices</span><span class="p">))</span>
            <span class="n">create_update_meraki_host_services</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">nagiosserviceitems</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="n">merakihostnames</span><span class="p">)</span>
</code></pre></div>
- <code>create_update_meraki_host()</code> and <code>create_update_meraki_host_services()</code> are responsible for adding/updating hosts and their services in Nagios XI.
- VLAN and IP logic ensures correct addressing for appliances.</p>
<hr />
<h2 id="7-applying-configuration">7. Applying Configuration</h2>
<p>After all additions/updates, we apply the Nagios XI configuration:</p>
<div class="highlight"><pre><span></span><code><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;alias&#39;</span><span class="p">:</span> <span class="s1">&#39;Nagios XI&#39;</span><span class="p">,</span> <span class="s1">&#39;applyconfig&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">}</span>
<span class="n">call_nagios_api</span><span class="p">(</span><span class="s1">&#39;config/host/localhost&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;PUT&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
<span class="n">nagioshost</span> <span class="o">=</span> <span class="n">call_nagios_api</span><span class="p">(</span><span class="s1">&#39;objects/host&#39;</span><span class="p">)</span>
</code></pre></div>
<hr />
<h2 id="8-full-function-code-add_missing_network_device_to_nagios">8. Full Function Code: <code>add_missing_network_device_to_nagios</code></h2>
<p>Below is the complete function, ready to adapt for your own environment:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_missing_network_device_to_nagios</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># OID to obtain all host names from Meraki SNMP Dashboard</span>
        <span class="n">merakihostnames</span> <span class="o">=</span> <span class="n">get_snmp_data</span><span class="p">(</span>
            <span class="n">MERAKI_DASHBOARD_SNMP_HOST_NAME</span><span class="p">,</span> 
            <span class="n">MERAKI_DASHBOARD_SNMP_PORT</span><span class="p">,</span>
            <span class="s1">&#39;1.3.6.1.4.1.29671.1.1.4.1.2&#39;</span><span class="p">,</span>
            <span class="n">MERAKI_DASHBOARD_SNMP_COMMUNITY_STRING</span><span class="p">)</span>
        <span class="n">gdepOrganizations</span> <span class="o">=</span> <span class="n">dashboard</span><span class="o">.</span><span class="n">organizations</span><span class="o">.</span><span class="n">getOrganizations</span><span class="p">()</span>
        <span class="n">organizationid</span> <span class="o">=</span> <span class="n">gdepOrganizations</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
        <span class="n">gdepdevices</span> <span class="o">=</span> <span class="n">dashboard</span><span class="o">.</span><span class="n">organizations</span><span class="o">.</span><span class="n">getOrganizationDevices</span><span class="p">(</span><span class="n">organizationid</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">gdepnetworks</span> <span class="o">=</span> <span class="n">dashboard</span><span class="o">.</span><span class="n">organizations</span><span class="o">.</span><span class="n">getOrganizationNetworks</span><span class="p">(</span><span class="n">organizationid</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">network</span> <span class="ow">in</span> <span class="n">gdepnetworks</span><span class="p">:</span>
            <span class="n">networkupgrades</span> <span class="o">=</span> <span class="n">dashboard</span><span class="o">.</span><span class="n">networks</span><span class="o">.</span><span class="n">getNetworkFirmwareUpgrades</span><span class="p">(</span><span class="n">network</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;products&#39;</span> <span class="ow">in</span> <span class="n">networkupgrades</span><span class="p">):</span>
                <span class="n">products</span> <span class="o">=</span> <span class="n">networkupgrades</span><span class="p">[</span><span class="s1">&#39;products&#39;</span><span class="p">]</span>
                <span class="c1"># ...process firmware info as needed...</span>

        <span class="n">nagioshost</span> <span class="o">=</span> <span class="n">call_nagios_api</span><span class="p">(</span><span class="s1">&#39;objects/host&#39;</span><span class="p">)</span>
        <span class="n">nagioshostservices</span> <span class="o">=</span> <span class="n">call_nagios_api</span><span class="p">(</span><span class="s1">&#39;objects/service&#39;</span><span class="p">)</span>
        <span class="n">nagioshostconfig</span> <span class="o">=</span> <span class="n">call_nagios_api</span><span class="p">(</span><span class="s1">&#39;config/host&#39;</span><span class="p">)</span>
        <span class="n">nagioshostgroupmembers</span> <span class="o">=</span> <span class="n">call_nagios_api</span><span class="p">(</span><span class="s1">&#39;objects/hostgroupmembers&#39;</span><span class="p">)</span>
        <span class="n">nagioshostservicesconfig</span> <span class="o">=</span> <span class="n">call_nagios_api</span><span class="p">(</span><span class="s1">&#39;config/service&#39;</span><span class="p">)</span>

        <span class="n">SKIP_MERAKI_HOSTS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;tst&#39;</span><span class="p">,</span><span class="s1">&#39;tes&#39;</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">device</span> <span class="ow">in</span> <span class="n">gdepdevices</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">device</span><span class="p">[</span><span class="s1">&#39;productType&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;appliance&#39;</span><span class="p">):</span>
                <span class="c1"># ...handle appliance types...</span>
                <span class="k">pass</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">device</span><span class="p">[</span><span class="s1">&#39;productType&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;camera&#39;</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">device</span><span class="p">[</span><span class="s1">&#39;productType&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;switch&#39;</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">device</span><span class="p">[</span><span class="s1">&#39;productType&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;wireless&#39;</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="c1"># ...other device handling as needed...</span>
            <span class="n">nagioshostitems</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">nh</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">nh</span><span class="p">[</span><span class="s1">&#39;host_name&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">device</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">nagioshost</span><span class="p">))</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nagioshostitems</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">device</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="k">if</span> <span class="p">((</span><span class="nb">str</span><span class="p">(</span><span class="n">device</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">SKIP_MERAKI_HOSTS</span><span class="p">)):</span>
                        <span class="k">if</span> <span class="p">((</span><span class="nb">str</span><span class="p">(</span><span class="n">device</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">SKIP_MERAKI_HOSTS</span><span class="p">)):</span>
                            <span class="c1"># ...add to Nagios XI...</span>
                            <span class="k">pass</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">device</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">((</span><span class="nb">str</span><span class="p">(</span><span class="n">device</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">SKIP_MERAKI_HOSTS</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="p">((</span><span class="nb">str</span><span class="p">(</span><span class="n">device</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">SKIP_MERAKI_HOSTS</span><span class="p">)):</span>
                        <span class="k">if</span> <span class="p">((</span><span class="n">device</span><span class="p">[</span><span class="s1">&#39;productType&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;appliance&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;VMX&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">device</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">])):</span>
                            <span class="n">applianceVLANs</span> <span class="o">=</span> <span class="n">dashboard</span><span class="o">.</span><span class="n">appliance</span><span class="o">.</span><span class="n">getNetworkApplianceVlans</span><span class="p">(</span><span class="n">device</span><span class="p">[</span><span class="s1">&#39;networkId&#39;</span><span class="p">])</span>
                            <span class="n">vlan999</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">av</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">av</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;999&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">applianceVLANs</span><span class="p">))</span>
                            <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vlan999</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                                <span class="n">device</span><span class="p">[</span><span class="s1">&#39;lanIp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;0.0.0.0&#39;</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">device</span><span class="p">[</span><span class="s1">&#39;lanIp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vlan999</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;applianceIp&#39;</span><span class="p">]</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">device</span><span class="p">[</span><span class="s1">&#39;lanIp&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
                            <span class="n">device</span><span class="p">[</span><span class="s1">&#39;lanIp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;0.0.0.0&#39;</span>
                        <span class="n">create_update_meraki_host</span><span class="p">(</span><span class="n">device</span><span class="p">,</span><span class="n">nagioshostitems</span><span class="p">,</span><span class="n">gdepnetworks</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span>
                        <span class="n">nagiosserviceitems</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">ns</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">ns</span><span class="p">[</span><span class="s1">&#39;host_name&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">device</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">nagioshostservices</span><span class="p">))</span>
                        <span class="n">create_update_meraki_host_services</span><span class="p">(</span><span class="n">device</span><span class="p">,</span><span class="n">nagiosserviceitems</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="n">merakihostnames</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;alias&#39;</span><span class="p">:</span> <span class="s1">&#39;Nagios XI&#39;</span><span class="p">,</span> <span class="s1">&#39;applyconfig&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">}</span>
        <span class="n">call_nagios_api</span><span class="p">(</span><span class="s1">&#39;config/host/localhost&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;PUT&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
        <span class="n">nagioshost</span> <span class="o">=</span> <span class="n">call_nagios_api</span><span class="p">(</span><span class="s1">&#39;objects/host&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception_obj</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">exception_obj</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<hr />
<h2 id="9-conclusion">9. Conclusion</h2>
<p>This workflow ensures your Nagios XI monitoring system is always in sync with your actual Meraki device inventory, with full visibility into firmware status and device types. By automating device discovery, comparison, and configuration, you can maintain a reliable, up-to-date monitoring environment with minimal manual effort.</p>
<hr />
<h2 id="references">References</h2>
<ul>
<li><a href="https://developer.cisco.com/meraki/api-v1/">Cisco Meraki Dashboard API Documentation</a></li>
<li><a href="https://pypi.org/project/meraki/">Python meraki library</a></li>
</ul>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="June 30, 2025 21:58:08 UTC">June 30, 2025</span>
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections", "content.code.annotate", "content.code.copy"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.92b07e13.min.js"></script>
      
        <script src="../assets/custom.js"></script>
      
    
  </body>
</html>