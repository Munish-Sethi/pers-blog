
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A professional blog showcasing business problem solutions.">
      
      
      
        <link rel="canonical" href="https://munishsethi.com/azure-bcpdr-part1/">
      
      
        <link rel="prev" href="../avd-cleanup-obsolete-fsLogix-profiles/">
      
      
        <link rel="next" href="../azure-bcpdr-part2/">
      
      
      <link rel="icon" href="../None">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Business Coninuity Program / Diasister Recovery - Part 1 - Munish Sethi (Blog)</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/custom.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#azure-bcpdr-with-backup-restore-part-1-resource-group-storage-and-network-foundation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Munish Sethi (Blog)" class="md-header__button md-logo" aria-label="Munish Sethi (Blog)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Munish Sethi (Blog)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Business Coninuity Program / Diasister Recovery - Part 1
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Munish Sethi (Blog)" class="md-nav__button md-logo" aria-label="Munish Sethi (Blog)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Munish Sethi (Blog)
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Azure
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Azure
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-ad-certificate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate Based Authentication
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-billing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Download Azure Bill
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Download Azure Resource
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-query-recovery-services-vault/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Query Recovery Services Vault
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-ad-user/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Entra Users, User Groups and Licence assignments
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-ad-user-devices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Entra User Devices
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-container-schedule/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Orchestrating Scheduled Jobs (Container Instances)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../devops-build-container/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DevOps Build Container
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../devops-deploy-container-iac/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DevOps Deploy Container IaC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../devops-deploy-container-github-action/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DevOps Deploy Container Github Actions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../avd-custon-image-compute-gallery-part1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Building and Publishing an Custom Image
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../avd-publish-part2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deploying Azure Virtual Desktop (AVD) Desktops
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../avd-cleanup-obsolete-fsLogix-profiles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cleanup Obsolete FXLogix Profiles(AVD)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Business Coninuity Program / Diasister Recovery - Part 1
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Business Coninuity Program / Diasister Recovery - Part 1
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#why-this-approach" class="md-nav__link">
    <span class="md-ellipsis">
      Why This Approach?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-1-create-the-target-resource-group-manual" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Create the Target Resource Group (Manual)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-deploy-resource-groups-via-bicep" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Deploy Resource Groups via Bicep
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-create-staging-storage-account" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Create Staging Storage Account
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-create-network-security-groups-nsgs" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: Create Network Security Groups (NSGs)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-5-create-route-tables" class="md-nav__link">
    <span class="md-ellipsis">
      Step 5: Create Route Tables
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-6-create-virtual-networks-and-subnets" class="md-nav__link">
    <span class="md-ellipsis">
      Step 6: Create Virtual Networks and Subnets
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-bcpdr-part2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Business Continuity Program / Disaster Recovery - Part 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-bcpdr-github-action/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Business Continuity Program / Disaster Recovery - Git Hub Action
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-restore-from-backup-part1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Restore VM from RSV Backup - Part 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-restore-from-backup-part2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Restore VM from RSV Backup - Part 2
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Fabric
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Fabric
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fabric-wharehouse-fact-import/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Warehouse data import
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Cisco Meraki, Nagios XI & Manage Engine
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Cisco Meraki, Nagios XI & Manage Engine
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../meraki-unused-device-sync/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cisco Meraki Unused Devices
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../meraki-nagios-device-sync/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cisco Meraki Devices Discovery and Nagios Integration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../monitoring-itsm-integration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Integrating Monitoring System with ITSM System
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../meraki-vm-deployment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deploying Cisco Meraki vMX
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Active Directory Domain Services
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Active Directory Domain Services
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adds-user-creation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Create ADDS User
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adds-user-update/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Update ADDS User
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    SAP
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            SAP
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sap-rfc-python-container/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Setup PyRFC in your Container
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sap-rfc-python/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Calling SAP RFC Function Modules from Python
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    O365
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            O365
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adaptive-card-consultant-review-part1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Outlook Actionable Adaptive Card - Part 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adaptive-card-consultant-review-part2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Outlook Actionable Adaptive Card - Part 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sharepoint-sites-enumeration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sharepoint Sites Enumeration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sharepoint-site-library-enumeration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sharepoint Document Library Enumeration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sharepoint-site-library-to-azure-fileshare/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Migrate Sharepoint Document Library to Azure File Share
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sap-concur-expense-reports-aggregation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Concur Expense Report Aggregation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../teams-user-number-assignment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Get all Teams Phone Assignment(s)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../deprovision-user/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deprovison User
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tenantallowblocklist/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tenant Allow Block List - False Positive
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    UKG
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            UKG
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ukg-sftp-file-transfer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Secure File Transfer with UKG Dimensions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ukg-api-employee-verification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Employee Verification via API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ukg-api-integration-and-dataview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Automating Integration Execution and Dataview extract
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Misc
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Misc
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../proofpoint-user-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Proof Point User Management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../github-clean-deployments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Clean GitHub Deployments
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#why-this-approach" class="md-nav__link">
    <span class="md-ellipsis">
      Why This Approach?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-1-create-the-target-resource-group-manual" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Create the Target Resource Group (Manual)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-deploy-resource-groups-via-bicep" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Deploy Resource Groups via Bicep
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-create-staging-storage-account" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Create Staging Storage Account
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-create-network-security-groups-nsgs" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: Create Network Security Groups (NSGs)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-5-create-route-tables" class="md-nav__link">
    <span class="md-ellipsis">
      Step 5: Create Route Tables
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-6-create-virtual-networks-and-subnets" class="md-nav__link">
    <span class="md-ellipsis">
      Step 6: Create Virtual Networks and Subnets
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="azure-bcpdr-with-backup-restore-part-1-resource-group-storage-and-network-foundation">Azure BCP/DR with Backup &amp; Restore: Part 1 – Resource Group, Storage, and Network Foundation</h1>
<p>This multi-part technical blog series walks you through a practical, cost-effective approach to Business Continuity and Disaster Recovery (BCP/DR) in Azure using backup and restore, rather than Azure Site Recovery. The scenario targets restoring all critical infrastructure from Azure East (primary) to Azure West (DR region). Each step is explained with code and rationale, so you can duplicate this in your own environment.</p>
<p><strong><a href="../azure-bcpdr-part2/">Part 2: Compute, Firewall, and Final Steps</a></strong></p>
<hr />
<h2 id="why-this-approach">Why This Approach?</h2>
<ul>
<li><strong>Cost-Effective:</strong> Backup and restore avoids the ongoing costs of Azure Site Recovery (ASR) replication.</li>
<li><strong>Simplicity:</strong> You control what is restored and when, with clear, auditable steps.</li>
<li><strong>RTO/RPO:</strong> Recovery Time Objective (RTO) and Recovery Point Objective (RPO) are acceptable for many workloads, as restore times are predictable and backups are recent.</li>
<li><strong>Flexibility:</strong> You can restore to any region, in this case from East to West US.</li>
</ul>
<hr />
<h2 id="step-1-create-the-target-resource-group-manual">Step 1: Create the Target Resource Group (Manual)</h2>
<p>This is the only step that must be done manually in the Azure Portal or CLI. It creates the DR resource group in the target region (West US).</p>
<ul>
<li><strong>Resource Group Name:</strong> <code>dr-rg-gdep-pwus-deployment</code></li>
<li><strong>Region:</strong> West US</li>
<li><strong>Tags:</strong> Infrastructure, Disaster Recovery</li>
</ul>
<p><strong>Command:</strong>
<div class="highlight"><pre><span></span><code>az<span class="w"> </span>group<span class="w"> </span>create<span class="w"> </span>--name<span class="w"> </span>dr-rg-gdep-pwus-deployment<span class="w"> </span>--location<span class="w"> </span>westus<span class="w"> </span>--tags<span class="w"> </span><span class="s2">&quot;Purpose=Infrastructure&quot;</span><span class="w"> </span><span class="s2">&quot;Type=DisasterRecovery&quot;</span>
</code></pre></div></p>
<hr />
<h2 id="step-2-deploy-resource-groups-via-bicep">Step 2: Deploy Resource Groups via Bicep</h2>
<p>This step uses a Bicep template to deploy any additional resource groups needed for the DR environment.</p>
<p><strong>Command:</strong>
<div class="highlight"><pre><span></span><code>az<span class="w"> </span>deployment<span class="w"> </span>group<span class="w"> </span>create<span class="w"> </span>--name<span class="w"> </span>gdepdr-rg<span class="w"> </span>--template-file<span class="w"> </span>./rg/rg_main.bicep<span class="w"> </span>--resource-group<span class="w"> </span>dr-rg-gdep-pwus-deployment
</code></pre></div></p>
<p><strong>Bicep Code: <code>rg_main.bicep</code></strong>
<div class="highlight"><pre><span></span><code>param location string = &#39;westus&#39;
var environmetag = &#39;Disaster Recovery&#39;

param resourcegroups2create array = [
  &#39;dr-rg-gdep-pwus-infrastructure&#39;
  &#39;dr-rg-gdep-pwus-vnets&#39;
  &#39;dr-rg-gdep-pwus-fortinet&#39;
  &#39;dr-rg-gdep-pwus-meraki-sdwan&#39;
]

module rggdepwus &#39;./rg.bicep&#39; = [for rggroupname in resourcegroups2create: {
  name: &#39;${deployment().name}-${rggroupname}&#39;
  scope:subscription()
  params: {
    name: rggroupname
    location: location
    tags: {Application:&#39;Infrastructure&#39;,Environment: environmetag}
    }
}]
</code></pre></div></p>
<p><strong>Supporting Bicep: <code>rg.bicep</code></strong>
<div class="highlight"><pre><span></span><code>targetScope=&#39;subscription&#39;

param name string 
param location string
param tags object

resource rggdepdrwus &#39;Microsoft.Resources/resourceGroups@2022-09-01&#39; = {
  name: name
  location: location
  tags: tags
}
output resourceGroupName string = rggdepdrwus.name
</code></pre></div></p>
<p><strong>Explanation:</strong>
- <code>rg_main.bicep</code> loops through a list of DR resource group names and deploys each using the <code>rg.bicep</code> module.
- <code>rg.bicep</code> creates a resource group at the subscription level with the specified name, location, and tags.
- This ensures all required DR resource groups are created consistently and tagged for easy management.</p>
<hr />
<h2 id="step-3-create-staging-storage-account">Step 3: Create Staging Storage Account</h2>
<p>Deploy a storage account for staging backups and other DR artifacts.</p>
<p><strong>Command:</strong>
<div class="highlight"><pre><span></span><code>az<span class="w"> </span>deployment<span class="w"> </span>group<span class="w"> </span>create<span class="w"> </span>--name<span class="w"> </span>gdepdr-sa-staging<span class="w"> </span>--resource-group<span class="w"> </span>dr-rg-gdep-pwus-deployment<span class="w"> </span>--template-file<span class="w"> </span>./storage/sa/sa_staging.bicep
</code></pre></div></p>
<p><strong>Bicep Code: <code>sa_staging.bicep</code></strong>
<div class="highlight"><pre><span></span><code>param location string = resourceGroup().location
var applicationtag = &#39;Infrastructure&#39;
var environmetag = &#39;Disaster Recovery&#39;
var infrastructure_rg_name = &#39;dr-rg-gdep-pwus-infrastructure&#39;

@description(&#39;This Storage Account is used as a Staging account to restore VM(s)&#39;)
module sagdepdrwusstaging &#39;./sa.bicep&#39; = {
  name: &#39;${deployment().name}-sa-gdep-pwus-staging&#39;
  scope: resourceGroup(infrastructure_rg_name)
  params: {
    name: &#39;storegdeppwusstaging&#39;
    location: location
    tags: { Application: applicationtag, Environment: environmetag }
    properties: {
      accessTier: &#39;Hot&#39;
      allowBlobPublicAccess: false
      allowCrossTenantReplication: false
      allowSharedKeyAccess: true
      defaultToOAuthAuthentication: false
      dnsEndpointType: &#39;Standard&#39;
      encryption: {
        keySource: &#39;Microsoft.Storage&#39;
        requireInfrastructureEncryption: false
        services: {
          blob: {
            enabled: true
            keyType: &#39;Account&#39;
          }
          file: {
            enabled: true
            keyType: &#39;Account&#39;
          }
        }
      }
      largeFileSharesState: &#39;Enabled&#39;
      minimumTlsVersion: &#39;TLS1_2&#39;
      networkAcls: {
        bypass: &#39;AzureServices&#39;
        defaultAction: &#39;Allow&#39;
        ipRules: []
        virtualNetworkRules: []
      }
      publicNetworkAccess: &#39;Enabled&#39;
      supportsHttpsTrafficOnly: true
    }
  }
}
</code></pre></div></p>
<p><strong>Supporting Bicep: <code>sa.bicep</code></strong>
<div class="highlight"><pre><span></span><code>param location string
param name string
param tags object
param properties object

resource sagdepdrwus &#39;Microsoft.Storage/storageAccounts@2023-04-01&#39; = {
  name: name
  location: location
  tags: tags
  kind: &#39;StorageV2&#39;
  sku: {
    name: &#39;Standard_LRS&#39;
  }
  properties: properties
}

resource sagdepdrwusblobservices &#39;Microsoft.Storage/storageAccounts/blobServices@2023-04-01&#39; = {
  parent: sagdepdrwus
  name: &#39;default&#39;
  properties: {
    cors: {
      corsRules: []
    }
    deleteRetentionPolicy: {
      allowPermanentDelete: false
      enabled: false
    }
  }
}

resource sagdepdrwusfileservices &#39;Microsoft.Storage/storageAccounts/fileServices@2023-04-01&#39; = {
  parent: sagdepdrwus
  name: &#39;default&#39;
  properties: {
    cors: {
      corsRules: []
    }
    protocolSettings: {
      smb: {}
    }
  }
}

resource sagdepdrwusqueueservices &#39;Microsoft.Storage/storageAccounts/queueServices@2023-04-01&#39; = {
  parent: sagdepdrwus
  name: &#39;default&#39;
  properties: {
    cors: {
      corsRules: []
    }
  }
}

resource sagdepdrwustableservices &#39;Microsoft.Storage/storageAccounts/tableServices@2023-04-01&#39; = {
  parent: sagdepdrwus
  name: &#39;default&#39;
  properties: {
    cors: {
      corsRules: []
    }
  }
}
</code></pre></div></p>
<p><strong>Explanation:</strong>
- <code>sa_staging.bicep</code> deploys a storage account for DR staging in the infrastructure resource group, with secure settings and encryption.
- The <code>sa.bicep</code> module provisions the storage account and all required services (blob, file, queue, table).
- This storage account is used for storing backup files, scripts, and logs during the DR restore process.</p>
<hr />
<h2 id="step-4-create-network-security-groups-nsgs">Step 4: Create Network Security Groups (NSGs)</h2>
<p>Deploy NSGs to secure your DR environment.</p>
<p><strong>Command:</strong>
<div class="highlight"><pre><span></span><code>az<span class="w"> </span>deployment<span class="w"> </span>group<span class="w"> </span>create<span class="w"> </span>--name<span class="w"> </span>gdepdr-nsg<span class="w"> </span>--resource-group<span class="w"> </span>dr-rg-gdep-pwus-deployment<span class="w"> </span>--template-file<span class="w"> </span>./networking/nsg/nsg_main.bicep
</code></pre></div></p>
<p><strong>Bicep Code: <code>nsg_main.bicep</code></strong>
<div class="highlight"><pre><span></span><code>param location string = resourceGroup().location
var applicationtag = &#39;Infrastructure&#39;
var environmetag = &#39;Disaster Recovery&#39;
var infrastructure_rg_name = &#39;dr-rg-gdep-pwus-infrastructure&#39;
var fortinet_rg_name = &#39;dr-rg-gdep-pwus-fortinet&#39;

@description(&#39;Used By Most of our Subnets&#39;)
module nsggdepdrwusdefault &#39;./nsg.bicep&#39; = {
  name: &#39;${deployment().name}-nsg-gdep-pwus-default&#39;
  scope: resourceGroup(infrastructure_rg_name)
  params: {
    name: &#39;nsg-gdep-pwus-default&#39;
    location: location
    tags: { Application: applicationtag, Environment: environmetag }
    properties: {}
  }
}
@description(&#39;Used By Meraki Public Subnet&#39;)
module nsggdepdrwusmeraki &#39;./nsg.bicep&#39; = {
  name: &#39;${deployment().name}-nsg-gdep-pwus-meraki&#39;
  scope: resourceGroup(infrastructure_rg_name)
  params: {
    name: &#39;nsg-gdep-pwus-meraki&#39;
    location: location
    tags: { Application: applicationtag, Environment: environmetag }
    properties: {
      securityRules: [
        {
          name: &#39;AllowAnyCustom443Inbound&#39;
          type: &#39;Microsoft.Network/networkSecurityGroups/securityRules&#39;
          properties: {
            description: &#39;Per Abhishek this may be required when (if) we enable Cisco Anyconnect&#39;
            protocol: &#39;*&#39;
            sourcePortRange: &#39;*&#39;
            destinationPortRange: &#39;*&#39;
            sourceAddressPrefix: &#39;*&#39;
            destinationAddressPrefix: &#39;*&#39;
            access: &#39;Allow&#39;
            priority: 100
            direction: &#39;Inbound&#39;
            sourcePortRanges: []
            destinationPortRanges: []
            sourceAddressPrefixes: []
            destinationAddressPrefixes: []
          }
        }
        {
          name: &#39;AllowAnyCustom443InboundUDP&#39;
          type: &#39;Microsoft.Network/networkSecurityGroups/securityRules&#39;
          properties: {
            protocol: &#39;UDP&#39;
            sourcePortRange: &#39;443&#39;
            destinationPortRange: &#39;443&#39;
            sourceAddressPrefix: &#39;*&#39;
            destinationAddressPrefix: &#39;*&#39;
            access: &#39;Allow&#39;
            priority: 110
            direction: &#39;Inbound&#39;
            sourcePortRanges: []
            destinationPortRanges: []
            sourceAddressPrefixes: []
            destinationAddressPrefixes: []
          }
        }
        {
          name: &#39;AllowAny&#39;
          type: &#39;Microsoft.Network/networkSecurityGroups/securityRules&#39;
          properties: {
            protocol: &#39;*&#39;
            sourcePortRange: &#39;*&#39;
            destinationPortRange: &#39;*&#39;
            sourceAddressPrefix: &#39;*&#39;
            destinationAddressPrefix: &#39;*&#39;
            access: &#39;Allow&#39;
            priority: 120
            direction: &#39;Outbound&#39;
            sourcePortRanges: []
            destinationPortRanges: []
            sourceAddressPrefixes: []
            destinationAddressPrefixes: []
          }
        }
      ]
    }
  }
}
@description(&#39;Used By Fortinet Firewall&#39;)
module nsggdepdrwusfortinet &#39;./nsg.bicep&#39; = {
  name: &#39;${deployment().name}-nsg-gdep-pwus-fortinet&#39;
  scope: resourceGroup(fortinet_rg_name)
  params: {
    name: &#39;nsg-gdep-pwus-fortinet&#39;
    location: location
    tags: { Application: applicationtag, Environment: environmetag }
    properties: {
      securityRules: [
        {
          name: &#39;AllowAllOutbound&#39;
          properties: {
            access: &#39;Allow&#39;
            description: &#39;Allow all out&#39;
            destinationAddressPrefix: &#39;*&#39;
            destinationAddressPrefixes: []
            destinationPortRange: &#39;*&#39;
            destinationPortRanges: []
            direction: &#39;Outbound&#39;
            priority: 105
            protocol: &#39;*&#39;
            sourceAddressPrefix: &#39;*&#39;
            sourceAddressPrefixes: []
            sourcePortRange: &#39;*&#39;
            sourcePortRanges: []
          }
          type: &#39;Microsoft.Network/networkSecurityGroups/securityRules&#39;
        }
        {
          name: &#39;AllowAllInbound&#39;
          properties: {
            access: &#39;Allow&#39;
            destinationAddressPrefix: &#39;*&#39;
            destinationAddressPrefixes: []
            destinationPortRange: &#39;*&#39;
            destinationPortRanges: []
            direction: &#39;Inbound&#39;
            priority: 110
            protocol: &#39;*&#39;
            sourceAddressPrefix: &#39;*&#39;
            sourceAddressPrefixes: []
            sourcePortRange: &#39;*&#39;
            sourcePortRanges: []
          }
          type: &#39;Microsoft.Network/networkSecurityGroups/securityRules&#39;
        }
      ]
    }
  }
}
</code></pre></div></p>
<p><strong>Supporting Bicep: <code>nsg.bicep</code></strong>
<div class="highlight"><pre><span></span><code>param location string 
param name string 
param tags object
param properties object

resource nsggdepdrwus &#39;Microsoft.Network/networkSecurityGroups@2023-09-01&#39;={
  name:name
  location:location
  tags:tags
  properties:properties
}
</code></pre></div></p>
<p><strong>Explanation:</strong>
- <code>nsg_main.bicep</code> deploys three NSGs: default, Meraki, and Fortinet, each with appropriate rules for their subnet roles.
- The <code>nsg.bicep</code> module provisions the NSG with the specified rules and tags.
- NSGs are critical for controlling traffic flow and securing your DR network.</p>
<hr />
<h2 id="step-5-create-route-tables">Step 5: Create Route Tables</h2>
<p>Deploy User Defined Route (UDR) tables for custom routing.</p>
<p><strong>Command:</strong>
<div class="highlight"><pre><span></span><code>az<span class="w"> </span>deployment<span class="w"> </span>group<span class="w"> </span>create<span class="w"> </span>--name<span class="w"> </span>gdepdr-rt<span class="w"> </span>--resource-group<span class="w"> </span>dr-rg-gdep-pwus-deployment<span class="w"> </span>--template-file<span class="w"> </span>./networking/udr/udr_main.bicep
</code></pre></div></p>
<p><strong>Bicep Code: <code>udr_main.bicep</code></strong>
<div class="highlight"><pre><span></span><code>param location string = resourceGroup().location
var applicationtag = &#39;Infrastructure&#39;
var environmetag = &#39;Disaster Recovery&#39;

//var infrastructure_rg_name = &#39;dr-rg-gdep-pwus-infrastructure&#39;
var fortinet_rg_name = &#39;dr-rg-gdep-pwus-fortinet&#39;
var meraki_sdwan_rg_name = &#39;dr-rg-gdep-pwus-meraki-sdwan&#39;

@description(&#39;Used to route traffic intended to go to On Premise network from Azure Hub&#39;)
module udrgdepdrwushub2onprem &#39;./udr.bicep&#39; = {
  name: &#39;${deployment().name}-route-gdep-pwus-azurehub-onprem&#39;
  scope: resourceGroup(fortinet_rg_name)
  params: {
    name: &#39;route-gdep-pwus-azurehub-onprem&#39;
    location: location
    tags: { Application: applicationtag, Environment: environmetag }
    properties: {
      disableBgpRoutePropagation: false
      routes: [ ... ]
    }
  }
}
// ...additional modules for all required UDRs (see full code in repo)...
</code></pre></div></p>
<p><strong>Supporting Bicep: <code>udr.bicep</code></strong>
<div class="highlight"><pre><span></span><code>param location string 
param name string 
param tags object
param properties object

resource rtgdepdrwus &#39;Microsoft.Network/routeTables@2023-09-01&#39;={
  name:name
  location:location
  tags:tags
  properties:properties
}
</code></pre></div></p>
<p><strong>Explanation:</strong>
- <code>udr_main.bicep</code> deploys all required route tables for the DR environment, including routes for on-premises, spokes, and SDWAN.
- The <code>udr.bicep</code> module provisions each route table with the specified routes and settings.
- UDRs are essential for custom traffic flow and integration with firewalls and VPNs.</p>
<hr />
<h2 id="step-6-create-virtual-networks-and-subnets">Step 6: Create Virtual Networks and Subnets</h2>
<p>Deploy VNETs, subnets, and associate them with NSGs and UDRs.</p>
<p><strong>Command:</strong>
<div class="highlight"><pre><span></span><code>az<span class="w"> </span>deployment<span class="w"> </span>group<span class="w"> </span>create<span class="w"> </span>--name<span class="w"> </span>gdepdr-vnet<span class="w"> </span>--resource-group<span class="w"> </span>dr-rg-gdep-pwus-deployment<span class="w"> </span>--template-file<span class="w"> </span>./networking/vnet/vnet_main.bicep
</code></pre></div></p>
<p><strong>Bicep Code: <code>vnet_main.bicep</code></strong>
<div class="highlight"><pre><span></span><code>param location string = resourceGroup().location
var applicationtag = &#39;Infrastructure&#39;
var environmetag = &#39;Disaster Recovery&#39;

/*
var infrastructure_rg_name = &#39;dr-rg-gdep-pwus-infrastructure&#39;
var fortinet_rg_name = &#39;dr-rg-gdep-pwus-fortinet&#39;
var meraki_sdwan_rg_name = &#39;dr-rg-gdep-pwus-meraki-sdwan&#39;
*/
var vnet_rg_name = &#39;dr-rg-gdep-pwus-vnets&#39;

@description(&#39;Hub Virtual Network with NVA namely Fortinet Firewall&#39;)
module vnetgdepdrwusfortinet &#39;./vnet.bicep&#39; = {
  name: &#39;${deployment().name}-vnet-gdep-pwus-fortinet&#39;
  scope: resourceGroup(vnet_rg_name)
  params: {
    name: &#39;vnet-gdep-pwus-fortinet&#39;
    location: location
    tags: { Application: applicationtag, Environment: environmetag }
    properties: {
      addressSpace: {
        addressPrefixes: [ ... ]
      }
      dhcpOptions: {
        dnsServers: [ ... ]
      }
      enableDdosProtection: false
      subnets: [ ... ]
    }
  }
}
// ...additional modules for management and production spokes, and VNET peering (see full code in repo)...
</code></pre></div></p>
<p><strong>Supporting Bicep: <code>vnet.bicep</code></strong>
<div class="highlight"><pre><span></span><code>param location string 
param name string 
param tags object
param properties object

resource vnetgdepdrwus &#39;Microsoft.Network/virtualNetworks@2023-09-01&#39;={
  name:name
  location:location
  tags:tags
  properties:properties
}
output virtualnetworkname string = vnetgdepdrwus.name
</code></pre></div></p>
<p><strong>Explanation:</strong>
- <code>vnet_main.bicep</code> provisions all required virtual networks and subnets for the DR environment, including hub, management, and production spokes.
- Subnets are associated with NSGs and UDRs as needed, and VNET peering is configured for connectivity.
- The <code>vnet.bicep</code> module provisions each VNET with the specified address spaces, subnets, and settings.</p>
<hr />
<p><strong><a href="../azure-bcpdr-part2/">Continue to Part 2: Compute, Firewall, and Final Steps</a></strong></p>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="July 7, 2025 15:21:49 UTC">July 7, 2025</span>
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections", "content.code.annotate", "content.code.copy"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="../assets/custom.js"></script>
      
    
  </body>
</html>